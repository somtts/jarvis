angular.module("JarvisApp","ngMaterial ngMdIcons ngSanitize restangular angular-websocket ui.router ui.router.router pascalprecht.translate ngCookies hljs ui.tree JarvisApp.websocket JarvisApp.config JarvisApp.theme JarvisApp.routes JarvisApp.services JarvisApp.services.filter JarvisApp.services.generic JarvisApp.services.scope JarvisApp.directives.files JarvisApp.directives.widgets jarvis.directives.navigator jarvis.directives.command jarvis.directives.cron jarvis.directives.scenario jarvis.directives.trigger jarvis.directives.configuration jarvis.directives.notification jarvis.directives.connector jarvis.directives.block jarvis.directives.device jarvis.directives.event jarvis.directives.home jarvis.directives.plugin jarvis.directives.property jarvis.directives.snapshot jarvis.directives.view".split(" "));
"use strict";var jarvisServicesUrl="/services",jarvisApiUrl="/api",myAppServices=angular.module("JarvisApp.services",["ngResource"]);
myAppServices.factory("toastService",["$log","$mdToast",function(a,b){a=angular.injector(["ng"]).get("$log");a.info("toastService",b);var c;return c={toastPosition:{bottom:!0,top:!1,left:!1,right:!0},getToastPosition:function(){return Object.keys(c.toastPosition).filter(function(a){return c.toastPosition[a]}).join(" ")},failure:function(e){a.error(e);b.show(b.simple().content(e).position(c.getToastPosition()).hideDelay(3E3).theme("failure-toast"))},info:function(e){a.info(e,c.getToastPosition());
b.show(b.simple().position(c.getToastPosition()).textContent(e).hideDelay(3E3).capsule(!0))}}}]);myAppServices.factory("$store",["$log","$rootScope",function(a,b){a.info("$store");var c={};return{collection:c,push:function(b,d,f){void 0===c[b]&&(c[b]={});a.info("$store",b,d,f);c[b][d]=f},get:function(a,b,f){return void 0==c||void 0==c[a]||void 0==c[a][b]?f:c[a][b]}}}]);
myAppServices.factory("oauth2ResourceService",["$rootScope","$log","$window","$mdDialog","$location","Restangular",function(a,b,c,e,d,f){b=angular.injector(["ng"]).get("$log");return{me:function(a,c,e){b.info("Fix JarvisAuthToken to",a);f.setDefaultHeaders({JarvisAuthToken:a});f.one("/api/profile/me").get().then(function(a){c(a)},function(a){e(a)})},config:function(a,b,c){f.one("oauth2").get(a).then(function(a){b(a)},function(a){c(a)})},connect:function(c,d){b.info("connect with",d);var k=this;k.me(d,
function(d){b.info("profile",d);e.hide();a.profile=d;c.boot()},function(a){b.warn("no profile");k.login()})},login:function(){e.show({controller:"oauth2DialogCtrl",templateUrl:"/ui/js/partials/dialog/oauth2Dialog.tmpl.html",parent:angular.element(document.body),clickOutsideToClose:!1,fullscreen:!1})}}}]);"use strict";myAppServices=angular.module("JarvisApp.services.filter",[]);
myAppServices.factory("filterService",["Restangular",function(a){return{plain:function(b){if(angular.isArray(b)||angular.isObject(b))b=a.stripRestangular(b),delete b.originalElement;return b}}}]);"use strict";
angular.module("JarvisApp.services.generic",["JarvisApp.services.filter"]).factory("genericResourceService",["$log","Restangular","filterService","toastService",function(a,b,c,e){var d={findAll:function(g,e,d){var f=function(b){var d=[];_.forEach(b,function(a){d.push(c.plain(a))});a.debug("[FIND]",g,d);e&&e(d)};1==g.length?b.all("/api/"+g[0]).getList().then(f,function(a){d(a)}):b.all("/api/"+g[0]).all(g[1]).getList().then(f,function(a){d(a)})},get:function(e,d,k,f){var l=function(b){b=c.plain(b);
a.debug("[GET]",e,b);void 0!=k&&k(b)};1==e.length?b.one("/api/"+e[0],d).get().then(l,function(a){f(a)}):b.all("/api/"+e[0]).one(e[1],d).get().then(l,function(a){f(a)})},delete:function(e,d,k,f){var l=function(b){b=c.plain(b);a.debug("[DELETE]",e,b);void 0!=k&&k(b)};1==e.length?b.one("/api/"+e[0],d).remove().then(l,function(a){f(a)}):b.all("/api/"+e[0]).one(e[1],d).remove().then(l,function(a){f(a)})},put:function(e,d,k,f){var l=function(b){b=c.plain(b);a.debug("[PUT]",e,b);void 0!=k&&k(b)};1==e.length?
b.one("/api/"+e[0],d.id).customPUT(d).then(l,function(a){f(a)}):b.all("/api/"+e[0]).one(e[1],d.id).customPUT(d).then(l,function(a){f(a)})},post:function(e,d,k,f){var l=function(b){b=c.plain(b);a.debug("[POST]",e,b);void 0!=k&&k(b)};1==e.length?b.all("/api/"+e[0]).post(d).then(l,function(a){f(a)}):b.all("/api/"+e[0]).all(e[1]).post(d).then(l,function(a){f(a)})},task:function(e,d,f,n,l,m){var q=function(b){var d=c.plain(b);a.debug("[TASK]",b,e,d);void 0!=l&&l(d)};1==e.length?b.all("/api/"+e[0]).one(d).customPOST(n,
"",{task:f}).then(q,function(a){m(a)}):b.all("/api/"+e[0]).all(e[1]).one(d).customPOST(n,"",{task:f}).then(q,function(a){m(a)})}},f={findAll:function(e,d,f,n,l,m){var q=function(b){var m=[];_.forEach(b,function(a){m.push(c.plain(a))});a.debug("[FIND/L/"+f+"]",e,d,n,m);l(m)};1==d.length?1==e.length?b.one("/api/"+e[0],n).all(d[0]).getList({href:f}).then(q,function(a){m(a)}):b.all("/api/"+e[0]).one(e[1],n).all(d[0]).getList({href:f}).then(q,function(a){m(a)}):1==e.length?b.one("/api/"+e[0],n).all(d[0]).all(d[1]).getList({href:f}).then(q,
function(a){m(a)}):b.all("/api/"+e[0]).one(e[1],n).all(d[0]).all(d[1]).getList({href:f}).then(q,function(a){m(a)})},post:function(e,d,f,n,l,m,q,p){var r=function(b){b=c.plain(b);a.debug("[POST/L]",e,b);void 0!=q&&q(b)};void 0!=m&&(m.href=f);1==d.length?1==e.length?b.one("/api/"+e[0],n).one(d[0],l).customPOST(m).then(r,function(a){p(a)}):b.all("/api/"+e[0]).one(e[1],n).one(d[0],l).customPOST(m).then(r,function(a){p(a)}):1==e.length?b.one("/api/"+e[0],n).all(d[0]).one(d[1],l).customPOST(m).then(r,function(a){p(a)}):
b.all("/api/"+e[0]).one(e[1],n).all(d[0]).one(d[1],l).customPOST(m).then(r,function(a){p(a)})},put:function(e,d,f,n,l,m,q,p,r){var t=function(b){b=c.plain(b);a.debug("[PUT/L]",e,b);void 0!=p&&p(b)},s={},s=void 0===q?{}:q;s.href=f;1==d.length?1==e.length?b.one("/api/"+e[0],n).one(d[0],l).one(m).customPUT(s).then(t,function(a){r(a)}):b.all("/api/"+e[0]).one(e[1],n).one(d[0],l).one(m).customPUT(s).then(t,function(a){r(a)}):1==e.length?b.one("/api/"+e[0],n).all(d[0]).one(d[1],l).one(m).customPUT(s).then(t,
function(a){r(a)}):b.all("/api/"+e[0]).one(e[1],n).all(d[0]).one(d[1],l).one(m).customPUT(s).then(t,function(a){r(a)})},delete:function(e,d,f,n,l,m,q,p){var r=function(b){b=c.plain(b);a.debug("[DELETE/L]",e,b);void 0!=q&&q(b)};1==d.length?1==e.length?b.one("/api/"+e[0],n).one(d[0],l).remove({instance:m,href:f}).then(r,function(a){p(a)}):b.all("/api/"+e[0]).one(e[1],n).one(d[0],l).remove({instance:m,href:f}).then(r,function(a){p(a)}):1==e.length?b.one("/api/"+e[0],n).all(d[0]).one(d[1],l).remove({instance:m,
href:f}).then(r,function(a){p(a)}):b.all("/api/"+e[0]).one(e[1],n).all(d[0]).one(d[1],l).remove({instance:m,href:f}).then(r,function(a){p(a)})}};return{crud:function(a){return{findAll:function(b,e){return d.findAll(a,b,e)},get:function(b,e,c){return d.get(a,b,e,c)},delete:function(b,e,c){return d.delete(a,b,e,c)},put:function(b,e,c){return d.put(a,b,e,c)},post:function(b,e,c){return d.post(a,b,e,c)},task:function(b,e,c,f,m){return d.task(a,b,e,c,f,m)}}},links:function(a,b,e){void 0===e&&(e="HREF");
return{findAll:function(d,c,m){return f.findAll(a,b,e,d,c,m)},delete:function(d,c,m,q,p){return f.delete(a,b,e,d,c,m,q,p)},put:function(d,c,m,q,p,r){return f.put(a,b,e,d,c,m,q,p,r)},post:function(d,c,m,q,p){return f.post(a,b,e,d,c,m,q,p)}}},scope:{collections:{new:function(b,d,c,f,l){f.post(c,function(e){a.debug(b+" "+e.name+"#"+e.id+" created");d.push(e);l&&l(e)},e.failure)},findAll:function(b,d,c,f,l){a.debug("loading ",b,f);c.splice(0,c.length);f.findAll(d,function(e){_.forEach(e,function(a){c.push(a)});
a.debug("loaded ",b,c);l&&l(c)},e.failure)}},entity:{get:function(b,c,d){d.get(b,function(b){c(b);a.debug("[GET/scope] "+b.name+"#"+b.id)},e.failure)},remove:function(a,b,c,d){d.delete(c.id,function(d){e.info(b+" "+c.name+"#"+c.id+" removed");a()},e.failure)},save:function(a,b,c){c.put(b,function(c){e.info(a+" "+b.name+"#"+b.id+" updated")},e.failure)},duplicate:function(a,b,c,d){d.post(c,function(d){e.info(b+" "+c.name+"#"+c.id+" duplicated");a()},e.failure)}},link:{add:function(b,c,d,f,l){void 0!=
c&&void 0!=c.id&&""!=c.id&&f.post(b,c.id,d,function(b){a.debug("addLink",b);l.push(b)},e.failure)},save:function(b,c,d){void 0!=c&&void 0!=c.id&&""!=c.id&&d.put(b,c.id,c.instance,c.extended,function(b){a.debug("updateLink - before",c);a.debug("updateLink - after",b)},e.failure)},remove:function(b,c,d,f){void 0!=c&&void 0!=c.id&&""!=c.id&&d.delete(b,c.id,c.instance,function(b){var e=c.instance;_.remove(f,function(a){return a.instance==e});a.debug("removeLink - before",c)},e.failure)}},combo:{findAll:function(b,
c,d){a.debug("loading for select ",b,c);d.findAll(function(a){_.forEach(a,function(a){c.push({id:a.id,name:a.name})})},e.failure)}}}}}]).factory("genericPickerService",["$log","$mdDialog","toastService",function(a,b,c){return{pickers:{confirm:function(a,c,f,g){a=b.confirm().title(a).textContent(c).ariaLabel("Confirm").ok(f).cancel(g);return b.show(a)},nodes:function(a,c,f,g){b.show({controller:g,templateUrl:"js/partials/dialog/nodesDialog.tmpl.html",parent:angular.element(document.body),targetEvent:a,
clickOutsideToClose:!0}).then(function(a){c(a)},function(){f()})},graph:function(a,c,f,g,h){b.show({locals:{anchor:c},bindToController:!0,controller:h,templateUrl:"js/partials/dialog/graphDialog.tmpl.html",targetEvent:a,clickOutsideToClose:!0}).then(function(a){f(a)},function(){g()})}}}}]);"use strict";
angular.module("JarvisApp.services.scope",["JarvisApp.services.generic"]).factory("genericScopeService",["$log","$filter","genericResourceService","genericPickerService","toastService",function(a,b,c,e,d){return{scope:{resources:function(f,g,h,k,n,l){a.debug("inject default resources scope",k,l);h.create=function(a,b){c.scope.collections.new(k,g(),a,n,b)};h.new=function(a){c.scope.collections.new(k,g(),l,n,a)};h.crud=c.crud(k.split("/"));h.remove=function(c,d){e.pickers.confirm(b("translate")("action.drop",
{name:c.name,id:c.id}),"",b("translate")("yes"),b("translate")("no")).then(function(){a.debug("remove",c);var b=c.id;_.remove(g(),function(a){return a.id==b});h.crud.delete(c.id);d&&d(c)},function(){a.debug("abort")})};h.load=function(b){f([]);n.findAll(function(c){f(c);a.debug(k+"-ctrl",c,b);b&&b()},d.failure)}},resource:function(d,g,h,k,n,l,m){a.debug("inject default resource scope",g);d.remove=function(n){e.pickers.confirm(b("translate")("action.drop",{name:n.name,id:n.id}),"",b("translate")("yes"),
b("translate")("no")).then(function(){c.scope.entity.remove(function(){d.go(h)},g,n,k)},function(){a.debug("abort")})};d.save=function(a){c.scope.entity.save(g,a,k)};d.duplicate=function(a){c.scope.entity.duplicate(function(){d.go(h)},g,a,k)}},resourceLink:function(d,g,h,k,n,l,m,q,p){a.debug("inject link",l);g.add=function(b){a.debug("link::add",b);c.scope.link.add(q,b,m,l,d())};g.update=function(b){a.debug("link::update",b);c.scope.link.save(q,b,l)};g.drop=function(g){e.pickers.confirm(b("translate")("action.remove.link",
{name:g.name,id:g.id}),"",b("translate")("yes"),b("translate")("no")).then(function(){a.debug("link::drop",g);p&&p.remove?p.remove(g):c.scope.link.remove(q,g,l,d());p&&p.afterRemove&&p.afterRemove(g)},function(){a.debug("abort")})}}}}}]);"use strict";
angular.module("JarvisApp.config",["JarvisApp.directives.files"]).config(["RestangularProvider",function(a){a.setDefaultHeaders({"content-type":"application/json"});a.setFullRequestInterceptor(function(a,c,e,d,f,g,h){f["content-type"]="application/json";return{element:a,params:g,headers:f,httpConfig:h}});a.setResponseExtractor(function(a){angular.isObject(a)&&(a.originalElement=a);return a})}]).config(["$mdIconProvider",function(a){}]).config(["$translateProvider",function(a){a.useStaticFilesLoader({prefix:"js/l10n/",
suffix:".json"});a.preferredLanguage("fr_FR");a.useSanitizeValueStrategy(null)}]).controller("JarvisAppCtrl",["$rootScope","$scope","$log","$store","$notification","$http","$mdDialog","$mdSidenav","$mdMedia","$location","$window","$state","genericPickerService","toastService","jarvisWidgetDeviceService","jarvisWidgetEventService","jarvisWidgetConfigurationService","oauth2ResourceService",function(a,b,c,e,d,f,g,h,k,n,l,m,q,p,r,t,s,u){b.isJson=function(a){try{JSON.parse(a)}catch(b){return!1}return!0};
b.defaultValue=function(a,b){return void 0===a?b:a};b.loadSettings=function(){s.configuration.findAll(function(a){(a=_.find(a,"active"))?b.config=a:p.failure("No default settings")},p.failure)};b.saveSettings=function(){s.configuration.put(b.config,function(a){c.info("Updated",a)},p.failure)};b.closeSettings=function(){g.hide()};b.settings=function(a){var e=k("sm")||k("xs");g.show({scope:b,preserveScope:!0,templateUrl:"js/partials/dialog/settingsDialog.tmpl.html",parent:angular.element(document.body),
targetEvent:a,clickOutsideToClose:!0,fullscreen:e}).then(function(){c.warn("Saving settings")},function(){c.warn("Cancel settings save")})};b.markdown=new showdown.Converter({tables:"true",ghCodeBlocks:"true"});b.helper=function(a){c.debug("State",m.current.name);f.get("js/helps/fr/"+m.current.name+".markdown").then(function(a){a=b.markdown.makeHtml(a.data);b.help={content:a.replace(/<table>/g,'\x3ctable class\x3d"table table-striped table-bordered table-hover"\x3e')};c.debug("Help",b.help);h("right").toggle()})};
b.toggleSidenav=function(a){h(a).toggle()};b.location=function(a,b){h(a).toggle();n.path(b)};b.go=function(a,b){m.go(a,b)};b.emit=function(a,b){c.debug("JarvisAppCtrl::emit",a,b,a.trigger);t.event.post({trigger:a.trigger,timestamp:(new Date).toISOString(),fired:!0,number:b},function(a){c.debug("JarvisAppCtrl::emit",a);p.info("event "+a.trigger+"#"+a.id+" emitted")},p.failure)};b.execute=function(a){r.device.task(a.id,"execute",{},function(a){c.debug("JarvisAppCtrl::execute",a);b.renderdata=a},p.failure)};
b.graph=function(a,b){return q.pickers.graph(a,b,function(a){c.debug("Go")},function(){c.debug("Abort")},"graphDialogCtrl")};b.$watch(function(a,b,c){return e.collection},function(a,c,e){b.store=a});b.boot=function(){b.config={};b.version={angular:angular.version,angularmd:window.ngMaterial};c.info("JarvisAppCtrl",b.version);b.media=k("xs");b.$watch(function(){return k("xs")},function(a){a&&(b.media="xs")});b.$watch(function(){return k("gt-xs")},function(a){a&&(b.media="gt-xs")});b.$watch(function(){return k("sm")},
function(a){a&&(b.media="sm")});b.$watch(function(){return k("gt-sm")},function(a){a&&(b.media="gt-sm")});b.$watch(function(){return k("md")},function(a){a&&(b.media="md")});b.$watch(function(){return k("gt-md")},function(a){a&&(b.media="gt-md")});b.$watch(function(){return k("lg")},function(a){a&&(b.media="lg")});b.$watch(function(){return k("gt-lg")},function(a){a&&(b.media="gt-lg")});b.$watch(function(){return k("xl")},function(a){a&&(b.media="xl")});b.$watch(function(){return k("print")},function(a){a&&
(b.media="print")});hljs.initHighlightingOnLoad();b.loadSettings();c.info("JarvisAppCtrl configured")};u.connect(b)}]).controller("extractTokenCtrl",["$scope","$log","$location","$rootScope","$state","oauth2ResourceService",function(a,b,c,e,d,f){b.warn("extractTokenCtrl",d);b=c.path().substr(1).split("\x26");e={};for(d=0;d<b.length;d++){var g=b[d].split("\x3d"),h=g[0];e[h]=g[1];"access_token"===h&&(f.connect(a,e.access_token),c.path("/home"))}}]).controller("oauth2DialogCtrl",["$scope","$window",
"$log","$mdDialog","oauth2ResourceService",function(a,b,c,e,d){a.hide=function(){e.hide()};a.cancel=function(){e.cancel()};a.answer=function(a){d.config({client:a.client,oauth2_redirect_uri:b.location.href.split("#")[0]},function(a){c.info("JarvisAppCtrl configured with",a);b.location.href=a.url},function(a){c.warn("no oauth2 configuration",a)});e.hide()}}]).controller("graphDialogCtrl",["$scope","$log","$mdDialog",function(a,b,c){b.info("graphDialogCtrl");a.hide=function(){c.hide()};a.cancel=function(){c.cancel()};
a.answer=function(a){c.hide(a)}}]).controller("pickPluginDialogCtrl",["$scope","$log","$mdDialog","genericResourceService","toastService",function(a,b,c,e,d){b.info("pickPluginDialogCtrl");a.hide=function(){c.hide()};a.cancel=function(){c.cancel()};a.answer=function(a){c.hide(a)};a.elementsPicker=[{name:"Connected Objects",selectable:!1,nodes:[]},{name:"Plugin Scripts",selectable:!1,nodes:[]}];a.crudDevice=e.crud(["devices"]);a.crudDevice.findAll(function(b){_.each(b,function(b){b.selectable=!1;a.elementsPicker[0].nodes.push(b)})},
d.failure);a.crudScript=e.crud(["plugins","scripts"]);a.crudScript.findAll(function(b){_.each(b,function(b){b.selectable=!0;a.elementsPicker[1].nodes.push(b)})},d.failure)}]).controller("pickDeviceDialogCtrl",["$scope","$log","$mdDialog","genericResourceService","toastService",function(a,b,c,e,d){b.info("pickDeviceDialogCtrl");a.hide=function(){c.hide()};a.cancel=function(){c.cancel()};a.answer=function(a){c.hide(a)};a.elementsPicker=[{name:"Connected Objects",selectable:!1,nodes:[]},{name:"Plugin Scripts",
selectable:!1,nodes:[]}];a.crudDevice=e.crud(["devices"]);a.crudDevice.findAll(function(b){_.each(b,function(b){b.selectable=!0;a.elementsPicker[0].nodes.push(b)})},d.failure);a.crudScript=e.crud(["plugins","scripts"]);a.crudScript.findAll(function(b){_.each(b,function(b){b.selectable=!1;a.elementsPicker[1].nodes.push(b)})},d.failure)}]).controller("pickCommandDialogCtrl",["$scope","$log","$mdDialog","genericResourceService","toastService",function(a,b,c,e,d){b.info("pickCommandDialogCtrl");a.hide=
function(){c.hide()};a.cancel=function(){c.cancel()};a.answer=function(a){c.hide(a)};a.elementsPicker=[{name:"Commands",selectable:!1,nodes:[]}];a.crud=e.crud(["commands"]);a.crud.findAll(function(b){_.each(b,function(b){b.selectable=!0;a.elementsPicker[0].nodes.push(b)})},d.failure)}]).controller("pickTriggerDialogCtrl",["$scope","$log","$mdDialog","genericResourceService","toastService",function(a,b,c,e,d){b.info("pickTriggerDialogCtrl");a.hide=function(){c.hide()};a.cancel=function(){c.cancel()};
a.answer=function(a){c.hide(a)};a.elementsPicker=[{name:"Triggers",selectable:!1,nodes:[]}];a.crud=e.crud(["triggers"]);a.crud.findAll(function(b){_.each(b,function(b){b.selectable=!0;a.elementsPicker[0].nodes.push(b)})},d.failure)}]).controller("pickNotificationDialogCtrl",["$scope","$log","$mdDialog","genericResourceService","toastService",function(a,b,c,e,d){b.info("pickNotificationDialogCtrl");a.hide=function(){c.hide()};a.cancel=function(){c.cancel()};a.answer=function(a){c.hide(a)};a.elementsPicker=
[{name:"Notifications",selectable:!1,nodes:[]}];a.crud=e.crud(["notifications"]);a.crud.findAll(function(b){_.each(b,function(b){b.selectable=!0;a.elementsPicker[0].nodes.push(b)})},d.failure)}]).controller("pickCronDialogCtrl",["$scope","$log","$mdDialog","genericResourceService","toastService",function(a,b,c,e,d){b.info("pickCronDialogCtrl");a.hide=function(){c.hide()};a.cancel=function(){c.cancel()};a.answer=function(a){c.hide(a)};a.elementsPicker=[{name:"Crontab objects",selectable:!1,nodes:[]}];
a.crud=e.crud(["crons"]);a.crud.findAll(function(b){_.each(b,function(b){b.selectable=!0;a.elementsPicker[0].nodes.push(b)})},d.failure)}]).controller("pickBlockDialogCtrl",["$scope","$log","$mdDialog","genericResourceService","toastService",function(a,b,c,e,d){b.info("pickBlockDialogCtrl");a.hide=function(){c.hide()};a.cancel=function(){c.cancel()};a.answer=function(a){c.hide(a)};a.elementsPicker=[{name:"Blocks",selectable:!1,nodes:[]}];a.crudBlock=e.crud(["blocks"]);a.crudBlock.findAll(function(b){_.each(b,
function(b){b.selectable=!0;a.elementsPicker[0].nodes.push(b)})},d.failure)}]);"use strict";
angular.module("JarvisApp.directives.files",[]).directive("appVersion",function(a){return function(b,c,e){c.text(a)}}).directive("fileModel",["$parse","$log",function(a,b){return{restrict:"A",link:function(b,e,d){var f=a(d.fileModel).assign;e.bind("change",function(){b.$apply(function(){f(b,e[0].files[0])})})}}}]).directive("fileSelect",["$window","$log",function(a,b){return{restrict:"A",require:"ngModel",link:function(c,e,d,f){var g=new a.FileReader;g.onload=function(){b.info("fileSelect.onload");
var a=g.result.substr(g.result.lastIndexOf(",")+1);b.debug("result:",g.result);b.debug("result base64 value:",a);f.$setViewValue(atob(a));"fileLoaded"in d&&c.$eval(d.fileLoaded)};g.onprogress=function(a){"fileProgress"in d&&c.$eval(d.fileProgress,{$total:a.total,$loaded:a.loaded})};g.onerror=function(){"fileError"in d&&c.$eval(d.fileError,{$error:g.error})};var h=d.fileSelect;e.bind("change",function(a){b.info("fileSelect.change");a=a.target.files[0];""===h||"text"===h?g.readAsText(a,"UTF-8"):"data"===
h&&g.readAsDataURL(a)})}}}]);"use strict";angular.module("JarvisApp.filters",[]).filter("interpolate",["version",function(a){return function(b){return String(b).replace(/\%VERSION\%/mg,a)}}]);"use strict";
angular.module("JarvisApp.routes",["JarvisApp.config"]).config(["$urlRouterProvider",function(a){a.otherwise("/home")}]).config(["$stateProvider",function(a){a.state("token_access",{url:"/access_token\x3d:accesToken",controller:"extractTokenCtrl",template:""}).state("helper-devices",{url:"/helper-devices",params:{resources:["crons","triggers","devices","plugins","commands"]},controller:"jarvisWidgetNavigatorCtrl",template:"\x3cjarvis-widget-navigator\x3e\x3c/jarvis-widget-navigator\x3e"}).state("helper-scenarii",
{url:"/helper-scenarii",params:{resources:["triggers","crons","scenarios","blocks","plugins"]},controller:"jarvisWidgetNavigatorCtrl",template:"\x3cjarvis-widget-navigator\x3e\x3c/jarvis-widget-navigator\x3e"}).state("helper-system",{url:"/helper-system",params:{resources:["configurations","notifications","properties","connectors","views"]},controller:"jarvisWidgetNavigatorCtrl",template:"\x3cjarvis-widget-navigator\x3e\x3c/jarvis-widget-navigator\x3e"}).state("home",{url:"/home",controller:"jarvisWidgetHomeCtrl",
template:"\x3cjarvis-widget-home\x3e\x3c/jarvis-widget-home\x3e"}).state("events",{url:"/events",controller:"jarvisWidgetEventsCtrl",template:"\x3cjarvis-widget-event\x3e\x3c/jarvis-widget-event\x3e"}).state("triggers",{url:"/triggers",controller:"jarvisWidgetTriggersCtrl",template:"\x3cjarvis-widget-triggers\x3e\x3c/jarvis-widget-triggers\x3e"}).state("triggers-by-id",{url:"/triggers/:id?tab",controller:"jarvisWidgetTriggerCtrl",template:"\x3cjarvis-widget-trigger\x3e\x3c/jarvis-widget-trigger\x3e"}).state("notifications",
{url:"/notifications",controller:"notificationsCtrl",template:"\x3cjarvis-widget-notifications\x3e\x3c/jarvis-widget-notifications\x3e"}).state("notifications-by-id",{url:"/notifications/:id?tab",controller:"notificationCtrl",template:"\x3cjarvis-widget-notification\x3e\x3c/jarvis-widget-notification\x3e"}).state("devices",{url:"/devices",controller:"devicesCtrl",template:"\x3cjarvis-widget-devices\x3e\x3c/jarvis-widget-devices\x3e"}).state("devices-by-id",{url:"/devices/:id?tab",controller:"deviceCtrl",
template:"\x3cjarvis-widget-device\x3e\x3c/jarvis-widget-device\x3e"}).state("plugins",{url:"/plugins",controller:"pluginsCtrl",template:"\x3cjarvis-widget-plugins\x3e\x3c/jarvis-widget-plugins\x3e"}).state("plugins-by-id-script",{url:"/plugins/scripts/:id?tab",controller:"pluginScriptCtrl",template:"\x3cjarvis-widget-plugin\x3e\x3c/jarvis-widget-plugin\x3e"}).state("commands",{url:"/commands",controller:"commandsCtrl",template:"\x3cjarvis-widget-commands\x3e\x3c/jarvis-widget-commands\x3e"}).state("commands-by-id",
{url:"/commands/:id?tab",controller:"commandCtrl",template:"\x3cjarvis-widget-command\x3e\x3c/jarvis-widget-command\x3e"}).state("views",{url:"/views",controller:"viewsCtrl",template:"\x3cjarvis-widget-views\x3e\x3c/jarvis-widget-views\x3e"}).state("views-by-id",{url:"/views/:id?tab",controller:"viewCtrl",template:"\x3cjarvis-widget-view\x3e\x3c/jarvis-widget-view\x3e"}).state("configurations",{url:"/configurations",controller:"configurationsCtrl",template:"\x3cjarvis-widget-configurations\x3e\x3c/jarvis-widget-configurations\x3e"}).state("configurations-by-id",
{url:"/configurations/:id?tab",controller:"configurationCtrl",template:"\x3cjarvis-widget-configuration\x3e\x3c/jarvis-widget-configuration\x3e"}).state("properties",{url:"/properties",controller:"propertiesCtrl",template:"\x3cjarvis-widget-properties\x3e\x3c/jarvis-widget-properties\x3e"}).state("properties-by-id",{url:"/properties/:id?tab",controller:"propertyCtrl",template:"\x3cjarvis-widget-property\x3e\x3c/jarvis-widget-property\x3e"}).state("connectors",{url:"/connectors",controller:"connectorsCtrl",
template:"\x3cjarvis-widget-connectors\x3e\x3c/jarvis-widget-connectors\x3e"}).state("connectors-by-id",{url:"/connectors/:id?tab",controller:"connectorCtrl",template:"\x3cjarvis-widget-connector\x3e\x3c/jarvis-widget-connector\x3e"}).state("snapshots",{url:"/snapshots",controller:"snapshotsCtrl",template:"\x3cjarvis-widget-snapshots\x3e\x3c/jarvis-widget-snapshots\x3e"}).state("snapshots-by-id",{url:"/snapshots/:id?tab",controller:"snapshotCtrl",template:"\x3cjarvis-widget-snapshot\x3e\x3c/jarvis-widget-snapshot\x3e"}).state("crons",
{url:"/crons",controller:"cronsCtrl",template:"\x3cjarvis-widget-crons\x3e\x3c/jarvis-widget-crons\x3e"}).state("crons-by-id",{url:"/crons/:id?tab",controller:"cronCtrl",template:"\x3cjarvis-widget-cron\x3e\x3c/jarvis-widget-cron\x3e"}).state("scenarios",{url:"/scenarios",controller:"scenariosCtrl",template:"\x3cjarvis-widget-scenarios\x3e\x3c/jarvis-widget-scenarios\x3e"}).state("scenarios-by-id",{url:"/scenarios/:id?tab",controller:"scenarioCtrl",template:"\x3cjarvis-widget-scenario\x3e\x3c/jarvis-widget-scenario\x3e"}).state("blocks",
{url:"/blocks",controller:"blocksCtrl",template:"\x3cjarvis-widget-blocks\x3e\x3c/jarvis-widget-blocks\x3e"}).state("blocks-by-id",{url:"/blocks/:id?tab",controller:"blockCtrl",template:"\x3cjarvis-widget-block\x3e\x3c/jarvis-widget-block\x3e"})}]);"use strict";
angular.module("JarvisApp.theme",["ngMaterial"]).config(["$mdThemingProvider",function(a){a.alwaysWatchTheme(!0);a.definePalette("customPrimary",{50:"#aaeafd",100:"#92e4fc",200:"#79defc",300:"#60d8fb",400:"#47d2fb",500:"#2ECCFA",600:"#15c6f9",700:"#06bbef",800:"#05a7d6",900:"#0594bd",A100:"#c3f0fe",A200:"#dcf7fe",A400:"#f5fdff",A700:"#0480a5"});a.definePalette("customAccent",{50:"#ffffff",100:"#ffffff",200:"#ffffff",300:"#f8fcfe",400:"#e3f4f9",500:"#CEECF5",600:"#b9e4f1",700:"#a4dcec",800:"#8ed3e8",
900:"#79cbe4",A100:"#ffffff",A200:"#ffffff",A400:"#ffffff",A700:"#64c3df"});a.definePalette("customWarn",{50:"#ff8080",100:"#ff6666",200:"#ff4d4d",300:"#ff3333",400:"#ff1a1a",500:"#FF0000",600:"#e60000",700:"#cc0000",800:"#b30000",900:"#990000",A100:"#ff9999",A200:"#ffb3b3",A400:"#ffcccc",A700:"#800000"});a.definePalette("customBackground",{50:"#ffffff",100:"#ffffff",200:"#ffffff",300:"#ffffff",400:"#ffffff",500:"#F2F2F2",600:"#e5e5e5",700:"#d8d8d8",800:"#cccccc",900:"#bfbfbf",A100:"#ffffff",A200:"#ffffff",
A400:"#ffffff",A700:"#b2b2b2"});a.theme("default").primaryPalette("customPrimary").accentPalette("customAccent").warnPalette("customWarn").backgroundPalette("customBackground")}]);"use strict";
angular.module("JarvisApp.websocket",["angular-websocket"]).factory("$notification",["$store","$log","$websocket","$window",function(a,b,c,e){b.info("$notification",e.location);b=c("ws://"+e.location.hostname+":"+e.location.port+"/stream/");b.onMessage(function(b){b=JSON.parse(b.data);a.push(b.classname,b.instance,b.data)});return{dataStream:b}}]);"use strict";
angular.module("JarvisApp.directives.widgets",["JarvisApp.services"]).directive("jarvisDefaultMenuBar",["$log","$parse",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/widget/tools/jarvis-default-menu-bar.html",require:"ngModel",link:function(a,b,d,f){a.closeMenu=d.close;a.element=function(){return f.$viewValue}}}}]).directive("jarvisPickElement",["$log","$parse","genericPickerService",function(a,b,c){return{restrict:"E",template:'\x3cmd-button aria-label\x3d"menu" class\x3d"md-icon-button" ng-click\x3d"pickItemDialog($event)"\x3e\x3cmd-tooltip\x3e{{pick.tooltips|translate}}\x3c/md-tooltip\x3e\x3cmd-icon md-font-icon\x3d"material-icons md-16"\x3e{{pick.icon}}\x3c/md-icon\x3e\x3c/md-button\x3e',
scope:{},link:function(e,d,f,g){e.pick={};e.pick.tooltips=f.tooltips;e.pick.icon=f.icon;e.pick.tooltips=f.tooltips;e.pick.ctrl=f.ctrl;e.pick.callback=f.callback;e.pickItemDialog=function(d,f){return c.pickers.nodes(d,function(a){b(e.pick.callback)(e.$parent)(a)},function(){a.debug("no picked element")},e.pick.ctrl)}}}}]).directive("typecommand",["$log",function(a){return{require:"ngModel",link:function(a,c,e,d){d.$validators.typecommand=function(a,b){return d.$isEmpty(a)?!1:"data"==a||"action"==a?
!0:!1}}}}]).directive("naturecommand",["$log",function(a){return{require:"ngModel",link:function(a,c,e,d){d.$validators.naturecommand=function(a,b){return d.$isEmpty(a)?!1:"text"==a||"json"==a||"xml"==a?!0:!1}}}}]).directive("jarvisCard",["$log","$parse",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/widget/tile/jarvis-card.html",scope:!1,link:function(c,e,d){a.debug("jarvis-card element",b(d.element)(c));a.debug("jarvis-card state",b(d.state)(c));c.element=b(d.element)(c);c.state=
b(d.state)(c)}}}]).directive("jarvisTile",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/widget/tile/jarvis-tile.html",link:function(b,e,d){a.debug("jarvis-tile")}}}]).directive("jarvisTileBoolean",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/widget/tile/jarvis-tile-boolean.html",link:function(b,e,d){a.debug("jarvis-tile-boolean")}}}]).directive("jarvisTileInt",["$log","$stateParams",function(a,b){return{restrict:"E",
templateUrl:"/ui/js/partials/widget/tile/jarvis-tile-int.html",link:function(b,e,d){a.debug("jarvis-tile-int")}}}]).directive("jarvisTilePercent",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/widget/tile/jarvis-tile-percent.html",link:function(b,e,d){a.debug("jarvis-tile-percent")}}}]).directive("jarvisInlineTemplate",["$log","$stateParams","$parse",function(a,b,c){return{restrict:"E",template:'\x3cdiv ng-include\x3d"getJarvisInlineTemplateUrl()"\x3e\x3c/div\x3e',
link:function(b,d,f){a.debug("jarvis-inline-template id",c(f.id)(b));b.getJarvisInlineTemplateUrl=function(){b.data=c(f.data)(b);return"/api/directives/html/devices/"+c(f.id)(b)}}}}]).directive("jarvisGauge",["$log","$store","$notification",function(a,b,c){return{restrict:"AC",controller:["$scope","$element","$attrs",function(c,d,f){a.debug("jarvis-gauge",f.id);c.gauge=(new Gauge(document.getElementById(f.id))).setOptions({fontSize:10,lines:10,angle:0,lineWidth:.32,pointer:{length:.9,strokeWidth:.035,
color:"#000000"},limitMax:"false",colorStart:"#6FADCF",colorStop:"#8FC0DA",strokeColor:"#E0E0E0",generateGradient:!0});c.gauge.maxValue=100;c.gauge.animationSpeed=10;c.gauge.set(0);c.$watch(function(){return 100*b.get("SystemIndicator","1",0).systemCpuLoad},function(a,b,d){c.gauge.set(a)})}]}}]);"use strict";
angular.module("jarvis.directives.block",["JarvisApp.services"]).controller("blocksCtrl",["$scope","$log","genericScopeService","genericPickerService","jarvisWidgetBlockService","toastService",function(a,b,c,e,d,f){b.debug("blocks-ctrl",a.blocks);c.scope.resources(function(b){a.blocks=b},function(){return a.blocks},a,"blocks",d.block,{name:"block name",icon:"list",parameter:"{}"});b.debug("blocks-ctrl",a.blocks)}]).controller("blockCtrl",["$scope","$log","$stateParams","genericScopeService","genericResourceService",
"genericPickerService","jarvisWidgetBlockService","toastService",function(a,b,c,e,d,f,g,h){e.scope.resource(a,"block","blocks",g.block);a.links={plugins:{"if":{},then:{},"else":{}},blocks:{then:{},"else":{}}};e.scope.resourceLink(function(){return a.plugins.if},a.links.plugins.if,"block","blocks",g.block,g.plugins.if,{order:"1"},c.id);e.scope.resourceLink(function(){return a.plugins.then},a.links.plugins.then,"block","blocks",g.block,g.plugins.then,{order:"1"},c.id);e.scope.resourceLink(function(){return a.plugins.else},
a.links.plugins.else,"block","blocks",g.block,g.plugins.else,{order:"1"},c.id);e.scope.resourceLink(function(){return a.blocks.then},a.links.blocks.then,"block","blocks",g.block,g.blocks.then,{order:"1"},c.id);e.scope.resourceLink(function(){return a.blocks.else},a.links.blocks.else,"block","blocks",g.block,g.blocks.else,{order:"1"},c.id);a.test=function(b){void 0!=b&&void 0!=b.id&&""!=b.id&&g.block.task(b.id,"test",{},function(b){a.testExpression="true"==b},h.failure)};a.execute=function(c){void 0!=
c&&void 0!=c.id&&""!=c.id&&g.block.task(c.id,"execute",{},function(e){b.debug("[BLOCK/test]",c,e);a.testExpression=e},h.failure)};a.load=function(){a.activeTab=c.tab;d.scope.entity.get(c.id,function(b){a.block=b},g.block);a.plugins={if:{},then:{},else:{}};a.plugins.if=[];d.scope.collections.findAll("plugins.if",c.id,a.plugins.if,g.plugins.if);a.plugins.then=[];d.scope.collections.findAll("plugins.then",c.id,a.plugins.then,g.plugins.then);a.plugins.else=[];d.scope.collections.findAll("plugins.else",
c.id,a.plugins.else,g.plugins.else);a.blocks={then:{},else:{}};a.blocks.then=[];d.scope.collections.findAll("blocks.then",c.id,a.blocks.then,g.blocks.then);a.blocks.else=[];d.scope.collections.findAll("blocks.else",c.id,a.blocks.else,g.blocks.else);b.debug("block-ctrl",a.block);b.debug("block-ctrl",a.blocks)}}]).factory("jarvisWidgetBlockService",["genericResourceService",function(a){return{block:a.crud(["blocks"]),plugins:{"if":a.links(["blocks"],["plugins","scripts"],"HREF_IF"),then:a.links(["blocks"],
["plugins","scripts"],"HREF_THEN"),"else":a.links(["blocks"],["plugins","scripts"],"HREF_ELSE")},blocks:{then:a.links(["blocks"],["blocks"],"HREF_THEN"),"else":a.links(["blocks"],["blocks"],"HREF_ELSE")}}}]).directive("jarvisWidgetBlocks",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/block/jarvis-widget-blocks.html",link:function(a,b,d){}}}]).directive("jarvisBlocks",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/block/partials/jarvis-blocks.html",
link:function(a,b,d){}}}]).directive("jarvisWidgetBlock",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/block/jarvis-widget-block.html",link:function(a,b,d){}}}]).directive("jarvisBlockGeneral",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/block/partials/jarvis-block-general.html",link:function(a,b,d){}}}]).directive("jarvisBlockElse",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/block/partials/jarvis-block-else.html",
link:function(a,b,d){}}}]).directive("jarvisBlockThen",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/block/partials/jarvis-block-then.html",link:function(a,b,d){}}}]);
angular.module("jarvis.directives.command",["JarvisApp.services"]).controller("commandsCtrl",["$scope","$log","genericScopeService","jarvisWidgetCommandService",function(a,b,c,e){c.scope.resources(function(b){a.commands=b},function(){return a.commands},a,"commands",e.command,{name:"command name",icon:"list"})}]).controller("commandCtrl",["$scope","$log","$stateParams","genericResourceService","genericScopeService","jarvisWidgetCommandService","toastService",function(a,b,c,e,d,f,g){d.scope.resource(a,
"command","commands",f.command);a.links={notifications:{}};d.scope.resourceLink(function(){return a.notifications},a.links.notifications,"notification","notifications",f.command,f.notifications,{order:"1"},c.id);a.execute=function(b){f.command.task(b.id,"execute",a.rawTestData,function(c){g.info("command "+b.name+"#"+b.id+" executed");a.output=angular.toJson(c,!0)},g.failure)};a.test=function(b){f.command.task(b.id,"test",a.rawTestData,function(c){g.info("command "+b.name+"#"+b.id+" tested");a.output=
angular.toJson(c,!0)},g.failure)};a.pretty=function(){b.debug("pretty",a.rawinput);a.jsonTestData=angular.toJson(a.rawTestData,!0)};a.submit=function(){a.rawTestData=angular.fromJson(a.editTestData);a.jsonTestData=angular.toJson(a.rawTestData,!0)};a.clear=function(){a.rawTestData={"default":"todo"};a.editTestData=angular.toJson(a.rawTestData,!0);a.jsonTestData=angular.toJson(a.rawTestData,!0);a.rawoutput={};a.output=angular.toJson({},!0)};a.load=function(){a.combo={visibles:f.bool,types:f.types};
a.clear();a.commands=[];e.scope.entity.get(c.id,function(b){a.command=b},f.command);a.notifications=[];e.scope.collections.findAll("notifications",c.id,a.notifications,f.notifications);b.info("command-ctrl")}}]).factory("jarvisWidgetCommandService",["genericResourceService",function(a){return{command:a.crud(["commands"]),notifications:a.links(["commands"],["notifications"]),bool:[{id:!0,value:"common.true"},{id:!1,value:"common.false"}],types:[{id:"SHELL",value:"command.shell"},{id:"COMMAND",value:"command.single"},
{id:"GROOVY",value:"command.groovy"},{id:"SSH",value:"command.ssh"},{id:"ZWAY",value:"command.zway"}]}}]).directive("jarvisWidgetCommands",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/command/jarvis-widget-commands.html",link:function(a,b,d){}}}]).directive("jarvisCommands",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/command/partials/jarvis-commands.html",link:function(a,b,d){}}}]).directive("jarvisWidgetCommand",
["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/command/jarvis-widget-command.html",link:function(a,b,d){}}}]).directive("jarvisCommand",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/command/partials/jarvis-command-general.html",link:function(b,e,d){a.debug("jarvis-command")}}}]).directive("jarvisCommandNotification",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/command/partials/jarvis-command-notification.html",
link:function(b,e,d){a.debug("jarvis-command-notification")}}}]).directive("jarvisCommandInput",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/command/partials/jarvis-command-input.html",link:function(b,e,d){a.debug("jarvis-command-input")}}}]).directive("jarvisCommandScript",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/command/partials/jarvis-command-script.html",link:function(b,e,d){a.debug("jarvis-command-script")}}}]).directive("jarvisCommandOutput",
["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/command/partials/jarvis-command-output.html",link:function(b,e,d){a.debug("jarvis-command-output")}}}]);"use strict";
angular.module("jarvis.directives.configuration",["JarvisApp.services"]).controller("configurationsCtrl",["$scope","$log","genericScopeService","jarvisWidgetConfigurationService",function(a,b,c,e){c.scope.resources(function(b){a.configurations=b},function(){return a.configurations},a,"configurations",e.configuration,{name:"default",opacity:"1",backgroundUrl:"http://artroyalephotography.com/wp-content/uploads/2011/08/minimal-gray-to-white-gradient-wallpapers_33797_1920x1200-1024x640.jpg"})}]).controller("configurationCtrl",
["$scope","$log","$stateParams","$mdDialog","genericResourceService","genericScopeService","jarvisWidgetConfigurationService","toastService",function(a,b,c,e,d,f,g,h){f.scope.resource(a,"configuration","configurations",g.configuration);a.load=function(){d.scope.entity.get(c.id,function(b){a.config=b},g.configuration);b.info("configuration-ctrl",a.configurations)}}]).factory("jarvisWidgetConfigurationService",["genericResourceService",function(a){return{configuration:a.crud(["configurations"])}}]).directive("jarvisWidgetConfigurations",
["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/configuration/jarvis-widget-configurations.html",link:function(a,b,d){}}}]).directive("jarvisConfigurations",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/configuration/partials/jarvis-configurations.html",link:function(b,e,d){a.debug("jarvis-configurations")}}}]).directive("jarvisWidgetConfiguration",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/configuration/jarvis-widget-configuration.html",
link:function(a,b,d){}}}]).directive("jarvisConfiguration",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/configuration/partials/jarvis-configuration-general.html",link:function(b,e,d){a.debug("jarvis-configuration")}}}]).directive("jarvisConfigurationSystem",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/configuration/partials/jarvis-configuration-system.html",link:function(b,e,d){a.debug("jarvis-configuration-system")}}}]);
"use strict";
angular.module("jarvis.directives.connector",["JarvisApp.services"]).controller("connectorsCtrl",["$scope","$log","genericScopeService","jarvisWidgetConnectorService",function(a,b,c,e){c.scope.resources(function(b){a.connectors=b},function(){return a.connectors},a,"connectors",e.connector,{name:"connector name",icon:"settings_input_antenna",isRenderer:!1,isSensor:!1,canAnswer:!1})}]).controller("connectorCtrl",["$scope","$log","$stateParams","$mdDialog","genericResourceService","genericScopeService","jarvisWidgetConnectorService",
"toastService",function(a,b,c,e,d,f,g,h){f.scope.resource(a,"connector","connectors",g.connector);a.ping=function(b){g.connector.task(b.id,"ping",b,function(b){a.status=angular.toJson(b,!0)},h.failure)};a.load=function(){d.scope.entity.get(c.id,function(b){a.connector=b},g.connector);b.info("connector-ctrl",a.connectors)}}]).factory("jarvisWidgetConnectorService",["genericResourceService",function(a){return{connector:a.crud(["connectors"])}}]).directive("jarvisWidgetConnectors",["$log","$stateParams",
function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/connector/jarvis-widget-connectors.html",link:function(a,b,d){}}}]).directive("jarvisConnectors",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/connector/partials/jarvis-connectors.html",link:function(a,b,d){}}}]).directive("jarvisWidgetConnector",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/connector/jarvis-widget-connector.html",link:function(a,b,d){}}}]).directive("jarvisConnectorGeneral",
["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/connector/partials/jarvis-connector-general.html",link:function(a,b,d){}}}]);"use strict";
angular.module("jarvis.directives.cron",["JarvisApp.services"]).controller("cronsCtrl",["$scope","$log","genericScopeService","jarvisWidgetCronService","toastService",function(a,b,c,e,d){c.scope.resources(function(b){a.crons=b},function(){return a.crons},a,"crons",e.cron,{name:"cron name",icon:"list",cron:"* * * * *"});a.start=function(){_.each(a.crons,function(a){e.cron.task(a.id,"toggle",{target:!0},function(a){d.info("crontab "+crontab.name+"#"+crontab.id+" toggled to "+crontab.status)},d.failure)})};
a.stop=function(){_.each(a.crons,function(a){e.cron.task(a.id,"toggle",{target:!1},function(a){d.info("crontab "+crontab.name+"#"+crontab.id+" toggled to "+crontab.status)},d.failure)})}}]).controller("cronCtrl",["$scope","$log","$stateParams","$filter","$http","genericResourceService","genericScopeService","jarvisWidgetCronService","toastService",function(a,b,c,e,d,f,g,h,k){g.scope.resource(a,"cron","crons",h.cron);a.toggle=function(a){b.info(a);h.cron.task(a.id,"toggle",{},function(a){k.info("crontab "+
crontab.name+"#"+crontab.id+" toggled to "+crontab.status)},k.failure)};a.test=function(a){b.info(a);h.cron.task(a.id,"test",{},function(a){k.info("crontab "+crontab.name+"#"+crontab.id+" toggled to "+crontab.status)},k.failure)};a.load=function(){a.crons=[];f.scope.entity.get(c.id,function(b){a.cron=b},h.cron);b.info("cron-ctrl",a.crons)}}]).factory("jarvisWidgetCronService",["genericResourceService",function(a){return{cron:a.crud(["crons"])}}]).directive("jarvisWidgetCrons",["$log","$stateParams",
function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/cron/jarvis-widget-crons.html",link:function(a,b,d){}}}]).directive("jarvisCrons",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/cron/partials/jarvis-crons.html",link:function(a,b,d){}}}]).directive("jarvisWidgetCron",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/cron/jarvis-widget-cron.html",link:function(a,b,d){}}}]).directive("jarvisCron",["$log","$stateParams",
function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/cron/partials/jarvis-cron-general.html",link:function(b,e,d){a.debug("jarvis-command")}}}]);"use strict";
angular.module("jarvis.directives.device",["JarvisApp.services"]).controller("devicesCtrl",["$scope","$log","genericScopeService","jarvisWidgetDeviceService",function(a,b,c,e){c.scope.resources(function(b){a.devices=b},function(){return a.devices},a,"devices",e.device,{name:"object name",icon:"list"})}]).controller("deviceCtrl",["$scope","$log","$state","$stateParams","jarvisWidgetDeviceService","genericScopeService","genericResourceService","toastService",function(a,b,c,e,d,f,g,h){a.getLink=function(){return a.plugins};
f.scope.resource(a,"device","devices",d.device);a.links={plugins:{},triggers:{},devices:{}};f.scope.resourceLink(function(){return a.plugins},a.links.plugins,"device","devices",d.device,d.plugins,{order:"1"},e.id);f.scope.resourceLink(function(){return a.triggers},a.links.triggers,"device","devices",d.device,d.triggers,{order:"1"},e.id);f.scope.resourceLink(function(){return a.devices},a.links.devices,"device","devices",d.device,d.devices,{order:"1"},e.id);a.render=function(c){d.device.task(c.id,
"render",{},function(c){b.debug("deviceCtrl::render",c);a.renderdata=c;a.output=angular.toJson(c,!0)},h.failure)};a.load=function(){a.activeTab=e.tab;g.scope.entity.get(e.id,function(b){a.device=b},d.device);a.plugins=[];g.scope.collections.findAll("plugins",e.id,a.plugins,d.plugins);a.devices=[];g.scope.collections.findAll("devices",e.id,a.devices,d.devices);a.triggers=[];g.scope.collections.findAll("triggers",e.id,a.triggers,d.triggers);b.info("device-ctrl")}}]).factory("jarvisWidgetDeviceService",
["genericResourceService",function(a){return{device:a.crud(["devices"]),plugins:a.links(["devices"],["plugins","scripts"]),devices:a.links(["devices"],["devices"]),triggers:a.links(["devices"],["triggers"])}}]).directive("jarvisWidgetDevices",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/device/jarvis-widget-devices.html",link:function(a,b,d){}}}]).directive("jarvisDevices",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/device/partials/jarvis-devices.html",
link:function(a,b,d){}}}]).directive("jarvisWidgetDevice",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/device/jarvis-widget-device.html",link:function(a,b,d){}}}]).directive("jarvisDeviceGeneral",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/device/partials/jarvis-device-general.html",link:function(a,b,d){}}}]).directive("jarvisDevicePlugin",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/device/partials/jarvis-device-plugin.html",
link:function(a,b,d){}}}]).directive("jarvisDeviceRender",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/device/partials/jarvis-device-render.html",link:function(a,b,d){}}}]);"use strict";
angular.module("jarvis.directives.event",["JarvisApp.services"]).controller("eventsCtrl",["$scope","$log","genericScopeService","genericResourceService","jarvisWidgetEventService",function(a,b,c,e,d){c.scope.resources(function(b){a.events=b},function(){return a.events},a,"events",d.event);a.crud=e.crud(["events"])}]).factory("jarvisWidgetEventService",["genericResourceService",function(a){return{event:a.crud(["events"])}}]).directive("jarvisWidgetEvents",["$log","$stateParams",function(a,b){return{restrict:"E",
templateUrl:"/ui/js/directives/events/jarvis-widget-events.html",link:function(a,b,d){}}}]).directive("jarvisEvents",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/events/jarvis-events.html",link:function(a,b,d){}}}]);"use strict";
angular.module("jarvis.directives.home",["JarvisApp.services"]).controller("jarvisWidgetHomeCtrl",["$scope","$rootScope","$store","$log","jarvisWidgetViewService","jarvisWidgetDeviceService","toastService","oauth2ResourceService",function(a,b,c,e,d,f,g,h){a.onSwipeLeft=function(){a.tabIndex>=a.views.length-1?a.tabIndex=a.views.length-1:a.tabIndex++};a.onSwipeRight=function(){0>=a.tabIndex?a.tabIndex=0:a.tabIndex--};a.selectTab=function(b,c){a.tabIndex=c};a.activeTab=function(b,c){return a.tabIndex==
c};a.load=function(){a.store=c;a.views=[];a.tabIndex=-1;d.view.findAll(function(b){var c=[];_.forEach(b,function(a){a.ishome&&(a.urlBackground="url('"+a.url+"')",c.push(a))});g.info(c.length+" view(s)");_.forEach(c,function(a){e.info("loading view",a);d.devices.findAll(a.id,function(b){a.devices=b;var c=_.after(a.devices.length,function(){e.debug("Linked devices to view",a.devices)});_.forEach(a.devices,function(a){f.device.task(a.id,"render",{},function(b){a.render=b;c(a)},g.failure)})},g.failure)});
a.views=c;0<a.views.length&&(a.tabIndex=0)},g.failure);e.info("home-ctrl")}}]).controller("helperCtrl",["$scope","$store","$log","jarvisWidgetViewService","jarvisWidgetDeviceService","toastService",function(a,b,c,e,d,f){}]).factory("jarvisWidgetHomeService",["genericResourceService",function(a){return{}}]).directive("jarvisWidgetHome",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/home/jarvis-widget-home.html",link:function(a,b,d){}}}]).directive("jarvisHome",
["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/home/partials/jarvis-home.html",link:function(a,b,d){}}}]);
angular.module("jarvis.directives.navigator",["JarvisApp.services"]).controller("jarvisWidgetNavigatorCtrl",["$scope","$log","$stateParams",function(a,b,c){a.resources=c.resources;a.answer=function(a){a.callback(a)}}]).factory("jarvisWidgetNavigatorService",["$q","$location","$log","jarvisWidgetSnapshotService","jarvisWidgetBlockService","jarvisWidgetConfigurationService","jarvisWidgetPropertyService","jarvisWidgetViewService","jarvisWidgetTriggerService","jarvisWidgetScenarioService","jarvisWidgetCronService",
"jarvisWidgetConnectorService","jarvisWidgetCommandService","jarvisWidgetPluginService","jarvisWidgetDeviceService",function(a,b,c,e,d,f,g,h,k,n,l,m,q,p,r){return{devices:function(){var c=a.defer();r.device.findAll(function(a){_.each(a,function(a){r.plugins.findAll(a.id,function(b){a.desc="";_.each(b,function(b){a.desc+=b.name})});a.selectable=!0;a.callback=function(a){b.path("/devices/"+a.id)};a.ext=angular.toJson(angular.fromJson(a.parameters),!0)});c.resolve({elements:a,title:"Devices",route:"/devices"})});
return c.promise},plugins:function(){var c=a.defer();p.scripts.findAll(function(a){_.each(a,function(a){p.commands.findAll(a.id,function(b){a.desc="";_.each(b,function(b){a.desc+=b.name})});a.selectable=!0;a.callback=function(a){b.path("/plugins/scripts/"+a.id)}});c.resolve({elements:a,title:"Plugins",route:"/plugins"})});return c.promise},commands:function(){var c=a.defer();q.command.findAll(function(a){_.each(a,function(a){a.ext=a.body;a.selectable=!0;a.callback=function(a){b.path("/commands/"+
a.id)}});c.resolve({elements:a,title:"Commands",route:"/commands"})});return c.promise},snapshots:function(){var c=a.defer();e.snapshot.findAll(function(a){_.each(a,function(a){a.selectable=!0;a.callback=function(a){b.path("/snapshots/"+a.id)}});c.resolve({elements:a,title:"Snapshots",route:"/snapshots"})});return c.promise},blocks:function(){var c=a.defer();d.block.findAll(function(a){_.each(a,function(a){a.selectable=!0;a.callback=function(a){b.path("/blocks/"+a.id)}});c.resolve({elements:a,title:"Blocks",
route:"/blocks"})});return c.promise},configurations:function(){var c=a.defer();f.configuration.findAll(function(a){_.each(a,function(a){a.selectable=!0;a.callback=function(a){b.path("/configurations/"+a.id)}});c.resolve({elements:a,title:"Configurations",route:"/configurations"})});return c.promise},properties:function(){var c=a.defer();g.property.findAll(function(a){_.each(a,function(a){a.selectable=!0;a.callback=function(a){b.path("/properties/"+a.id)}});c.resolve({elements:a,title:"Properties",
route:"/properties"})});return c.promise},views:function(){var c=a.defer();h.view.findAll(function(a){_.each(a,function(a){a.selectable=!0;a.callback=function(a){b.path("/views/"+a.id)}});c.resolve({elements:a,title:"Views",route:"/views"})});return c.promise},triggers:function(){var c=a.defer();k.trigger.findAll(function(a){_.each(a,function(a){a.selectable=!0;a.callback=function(a){b.path("/triggers/"+a.id)}});c.resolve({elements:a,title:"Triggers",route:"/triggers"})});return c.promise},scenarios:function(){var c=
a.defer();n.scenario.findAll(function(a){_.each(a,function(a){a.selectable=!0;a.callback=function(a){b.path("/scenarios/"+a.id)}});c.resolve({elements:a,title:"Scenarios",route:"/scenarios"})});return c.promise},crons:function(){var c=a.defer();l.cron.findAll(function(a){_.each(a,function(a){a.selectable=!0;a.callback=function(a){b.path("/crons/"+a.id)}});c.resolve({elements:a,title:"Crontab",route:"/crons"})});return c.promise},connectors:function(){var c=a.defer();m.connector.findAll(function(a){_.each(a,
function(a){a.selectable=!0;a.callback=function(a){b.path("/connectors/"+a.id)}});c.resolve({elements:a,title:"Connectors",route:"/connectors"})});return c.promise}}}]).directive("jarvisWidgetNavigator",["$log","$location","$stateParams","jarvisWidgetNavigatorService",function(a,b,c,e){return{restrict:"E",templateUrl:"/ui/js/directives/navigator/jarvis-widget-navigator.html",link:function(a,b,c){}}}]).directive("jarvisNavigator",["$log","$location","$stateParams","jarvisWidgetNavigatorService",function(a,
b,c,e){return{restrict:"E",templateUrl:"/ui/js/directives/navigator/partials/jarvis-navigator.html",link:function(a,c,g){a.elements=[];c=null;"devices"===g.resource&&(c=e.devices());"plugins"===g.resource&&(c=e.plugins());"commands"===g.resource&&(c=e.commands());"snapshots"===g.resource&&(c=e.snapshots());"blocks"===g.resource&&(c=e.blocks());"configurations"===g.resource&&(c=e.configurations());"properties"===g.resource&&(c=e.properties());"views"===g.resource&&(c=e.views());"triggers"===g.resource&&
(c=e.triggers());"scenarios"===g.resource&&(c=e.scenarios());"crons"===g.resource&&(c=e.crons());"connectors"===g.resource&&(c=e.connectors());null!=c&&c.then(function(c){a.elements.push({name:c.title,selectable:!0,callback:function(a){b.path(c.route)},nodes:c.elements})})}}}]);"use strict";
angular.module("jarvis.directives.notification",["JarvisApp.services"]).controller("notificationsCtrl",["$scope","$log","genericScopeService","jarvisWidgetNotificationService",function(a,b,c,e){c.scope.resources(function(b){a.notifications=b},function(){return a.notifications},a,"notifications",e.notification,{name:"notification name",icon:"settings_remote"})}]).controller("notificationCtrl",["$scope","$log","$stateParams","genericResourceService","genericScopeService","genericPickerService","jarvisWidgetNotificationService",
"toastService",function(a,b,c,e,d,f,g,h){d.scope.resource(a,"notification","notifications",g.notification);a.test=function(a,b,c,e){g.notification.task(a.id,"test",{text:b,title:c,subtext:e},function(b){h.info("notification "+a.name+"#"+a.id+" tested")},h.failure)};a.load=function(){a.combo={types:g.types};e.scope.entity.get(c.id,function(b){a.notification=b},g.notification);b.info("notification-ctrl",a.notification)}}]).factory("jarvisWidgetNotificationService",["genericResourceService",function(a){return{notification:a.crud(["notifications"]),
types:[{id:"SLACK",value:"notification.slack"},{id:"MAIL",value:"notification.mail"}]}}]).directive("jarvisWidgetNotifications",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/notification/jarvis-widget-notifications.html",link:function(a,b,d){}}}]).directive("jarvisWidgetNotification",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/notification/jarvis-widget-notification.html",link:function(a,b,d){}}}]).directive("jarvisNotifications",
["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/notification/partials/jarvis-notifications.html",link:function(a,b,d){}}}]).directive("jarvisNotification",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/notification/partials/jarvis-notification-general.html",link:function(a,b,d){}}}]).directive("jarvisNotificationTest",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/notification/partials/jarvis-notification-test.html",
link:function(a,b,d){}}}]);"use strict";
angular.module("jarvis.directives.plugin",["JarvisApp.services"]).controller("pluginsCtrl",["$scope","$log","genericScopeService","jarvisWidgetPluginService",function(a,b,c,e){c.scope.resources(function(b){a.plugins=b},function(){return a.plugins},a,"plugins/scripts",e.scripts,{name:"script name",icon:"list",type:"script"})}]).controller("pluginScriptCtrl",["$scope","$log","$stateParams","genericResourceService","genericScopeService","genericPickerService","jarvisWidgetPluginService","jarvisWidgetDeviceService",
"toastService",function(a,b,c,e,d,f,g,h,k){d.scope.resource(a,"script","plugins",g.scripts);a.links={commands:{}};d.scope.resourceLink(function(){return a.commands},a.links.commands,"script","plugins",g.scripts,g.commands,{order:"1",name:"noname",nature:"json",type:"data"},c.id);a.execute=function(c){void 0!=c&&void 0!=c.id&&""!=c.id&&g.scripts.task(c.id,"execute",a.rawTestData,function(e){b.debug("pluginScriptCtrl::execute",c,e);a.rawoutput=e;a.output=angular.toJson(e,!0)},k.failure)};a.render=function(c){void 0!=
c&&void 0!=c.id&&""!=c.id&&g.scripts.task(c.id,"render",a.rawTestData,function(e){b.debug("pluginScriptCtrl::render",c,e);a.rawoutput=e;a.output=angular.toJson(e,!0)},k.failure)};a.submit=function(){a.rawTestData=angular.fromJson(a.editTestData);a.jsonTestData=angular.toJson(a.rawTestData,!0)};a.clear=function(){a.rawoutput={};a.output=angular.toJson({},!0);a.rawTestData={};a.editTestData=angular.toJson(a.rawTestData,!0);a.jsonTestData=angular.toJson(a.rawTestData,!0)};a.setOwner=function(b){a.script.owner=
b.id};a.load=function(){a.activeTab=c.tab;a.clear();a.combo={booleans:[{id:!0,value:"True"},{id:!1,value:"False"}]};e.scope.entity.get(c.id,function(b){a.script=b},g.scripts);a.commands=[];e.scope.collections.findAll("commands",c.id,a.commands,g.commands);a.combo.owners=[{id:void 0,name:"device.empty"}];e.scope.combo.findAll("owner",a.combo.owners,h.device);b.info("script-ctrl",a.script)}}]).factory("jarvisWidgetPluginService",["Restangular","filterService","genericResourceService",function(a,b,c){return{plugins:{findAll:function(c,
d){var f=[],g=["scripts"],h=_.after(g.length,function(a){c(a)});_.forEach(g,function(c){a.all("plugins").all(c).getList().then(function(a){_.forEach(a,function(a){f.push(b.plain(a))});h(f)},function(a){d(a)})})}},scripts:c.crud(["plugins","scripts"]),commands:c.links(["plugins","scripts"],["commands"])}}]).directive("jarvisWidgetPlugins",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/plugin/jarvis-widget-plugins.html",link:function(a,b,d){}}}]).directive("jarvisPlugins",
["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/plugin/partials/jarvis-plugins.html",link:function(a,b,d){}}}]).directive("jarvisWidgetPlugin",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/plugin/jarvis-widget-plugin.html",link:function(a,b,d){}}}]).directive("jarvisPluginGeneral",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/plugin/partials/jarvis-plugin-general.html",link:function(a,
b,d){}}}]).directive("jarvisPluginResult",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/plugin/partials/jarvis-plugin-result.html",link:function(a,b,d){}}}]).directive("jarvisPluginScript",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/plugin/partials/jarvis-plugin-script.html",link:function(a,b,d){}}}]);"use strict";
angular.module("jarvis.directives.property",["JarvisApp.services"]).controller("propertiesCtrl",["$scope","$log","genericScopeService","jarvisWidgetPropertyService",function(a,b,c,e){c.scope.resources(function(b){a.properties=b},function(){return a.properties},a,"properties",e.property,{key:"key",value:"value"})}]).controller("propertyCtrl",["$scope","$log","$stateParams","$mdDialog","genericResourceService","genericScopeService","jarvisWidgetPropertyService","toastService",function(a,b,c,e,d,f,g,
h){f.scope.resource(a,"property","properties",g.property);a.load=function(){d.scope.entity.get(c.id,function(b){a.property=b},g.property);b.info("property-ctrl",a.properties)}}]).factory("jarvisWidgetPropertyService",["genericResourceService",function(a){return{property:a.crud(["properties"])}}]).directive("jarvisWidgetProperties",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/property/jarvis-widget-properties.html",link:function(a,b,d){}}}]).directive("jarvisProperties",
["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/property/partials/jarvis-properties.html",link:function(a,b,d){}}}]).directive("jarvisWidgetProperty",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/property/jarvis-widget-property.html",link:function(a,b,d){}}}]).directive("jarvisProperty",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/property/partials/jarvis-property-general.html",
link:function(a,b,d){}}}]);"use strict";
angular.module("jarvis.directives.scenario",["JarvisApp.services"]).controller("scenariosCtrl",["$scope","$log","genericScopeService","jarvisWidgetScenarioService","toastService",function(a,b,c,e,d){c.scope.resources(function(b){a.scenarios=b},function(){return a.scenarios},a,"scenarios",e.scenario,{name:"scenario name",icon:"list"})}]).controller("scenarioCtrl",["$scope","$log","$stateParams","$mdDialog","genericScopeService","genericResourceService","genericPickerService","jarvisWidgetScenarioService",
"jarvisWidgetBlockService","jarvisWidgetPluginService","toastService",function(a,b,c,e,d,f,g,h,k,n,l){d.scope.resource(a,"scenario","scenarios",h.scenario);a.links={blocks:{},triggers:{}};d.scope.resourceLink(function(){return a.blocks},a.links.blocks,"scenario","scenarios",h.scenario,h.blocks,{order:"1"},c.id);d.scope.resourceLink(function(){return a.triggers},a.links.triggers,"scenario","scenarios",h.scenario,h.triggers,{order:"1"},c.id);a.build=function(a){var c=[];_.each(a,function(a){b.debug("graph",
a.stage);var d="";_.each(a.nodes,function(a){a.start&&(d+="#"+a.id+"\x3d\x3estart: "+a.name+":\x3e"+a.longId+"\n");a.end&&(d+="#"+a.id+"\x3d\x3eend: "+a.name+":\x3e"+a.longId+"\n");a.activity&&(d+="#"+a.id+"\x3d\x3eoperation: "+a.name+":\x3e"+a.longId+"\n");a.gateway&&(d+="#"+a.id+"\x3d\x3econdition: "+a.name+":\x3e"+a.longId+"\n");a.call&&(d+="#"+a.id+"\x3d\x3esubroutine: "+a.name+":\x3e"+a.longId+"\n")});_.each(a.edges,function(b){d=a.nodes[b.sourceId].gateway?b.bool?d+("#"+b.sourceId+"(yes, right)-\x3e#"+
b.targetId+"\n"):d+("#"+b.sourceId+"(no)-\x3e#"+b.targetId+"\n"):d+("#"+b.sourceId+"-\x3e#"+b.targetId+"\n")});c.push({stage:a.stage,code:d})});return c};a.render=function(a){b.debug(a);$("#canvas").html("");_.each(a,function(a){$("#canvas").append("\x3ch4\x3e"+a.stage+"\x3c/h4\x3e");$("#canvas").append('\x3cdiv id\x3d"canvas-'+a.stage+'"\x3e\x3c/div\x3e')});_.each(a,function(a){b.info("Render",a.stage);flowchart.parse(a.code).drawSVG("canvas-"+a.stage,{"line-width":3,"line-length":50,"text-margin":10,
"font-size":12,font:"normal","font-family":"Helvetica","font-weight":"normal","font-color":"black","line-color":"black","element-color":"black",fill:"white","yes-text":"yes","no-text":"no","arrow-end":"block",scale:1,symbols:{start:{"font-color":"green","element-color":"green",fill:"yellow"},end:{"font-color":"red","element-color":"red",fill:"yellow"}},flowstate:{past:{fill:"#CCCCCC","font-size":12},current:{fill:"yellow","font-color":"red","font-weight":"bold"},future:{fill:"#FFFF99"},request:{fill:"blue"},
invalid:{fill:"#444444"},approved:{fill:"#58C4A3","font-size":12,"yes-text":"APPROVED","no-text":"n/a"},rejected:{fill:"#C45879","font-size":12,"yes-text":"n/a","no-text":"REJECTED"}}})})};a.chart=function(c){void 0!=c&&void 0!=c.id&&""!=c.id&&h.scenario.task(c.id,"render",{},function(d){b.debug("[SCENARIO/render]",c,d);a.codes=a.build(d);a.render(a.codes)},l.failure)};a.execute=function(c){void 0!=c&&void 0!=c.id&&""!=c.id&&h.scenario.task(c.id,"execute",{},function(d){b.debug("[SCENARIO/execute]",
c,d);a.console=d},l.failure)};a.load=function(){a.activeTab=c.tab;a.plugin={};f.scope.entity.get(c.id,function(b){a.scenario=b;a.chart(b)},h.scenario);a.blocks=[];f.scope.collections.findAll("blocks",c.id,a.blocks,h.blocks,function(a){_.forEach(a,function(a){a.plugins={};a.plugins.if=[];a.plugins.then=[];a.plugins.else=[];k.plugins.if.findAll(a.id,function(b){a.plugins.if=b});k.plugins.then.findAll(a.id,function(b){a.plugins.then=b});k.plugins.else.findAll(a.id,function(b){a.plugins.else=b});a.blocks=
{};a.blocks.then=[];a.blocks.else=[];k.blocks.then.findAll(a.id,function(b){a.blocks.then=b});k.blocks.else.findAll(a.id,function(b){a.blocks.else=b});b.debug("blocks.plugins",a.plugins);b.debug("blocks.blocks",a.blocks)})});a.triggers=[];f.scope.collections.findAll("triggers",c.id,a.triggers,h.triggers);b.debug("scenario-ctrl",a.scenario)}}]).factory("jarvisWidgetScenarioService",["genericResourceService",function(a){return{scenario:a.crud(["scenarios"]),blocks:a.links(["scenarios"],["blocks"]),
triggers:a.links(["scenarios"],["triggers"])}}]).directive("jarvisWidgetScenarios",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/scenario/jarvis-widget-scenarios.html",link:function(a,b,d){}}}]).directive("jarvisScenarios",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/scenario/partials/jarvis-scenarios.html",link:function(a,b,d){}}}]).directive("jarvisWidgetScenario",["$log","$stateParams",function(a,b){return{restrict:"E",
templateUrl:"/ui/js/directives/scenario/jarvis-widget-scenario.html",link:function(a,b,d){}}}]).directive("jarvisScenario",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/scenario/partials/jarvis-scenario-general.html",link:function(a,b,d){}}}]).directive("jarvisScenarioBlock",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/scenario/partials/jarvis-scenario-block.html",link:function(a,b,d){}}}]).directive("jarvisScenarioBlocks",
["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/scenario/partials/jarvis-scenario-blocks.html",link:function(a,b,d){}}}]).directive("jarvisScenarioConsole",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/scenario/partials/jarvis-scenario-console.html",link:function(a,b,d){}}}]).directive("jarvisScenarioGraph",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/scenario/partials/jarvis-scenario-graph.html",
link:function(a,b,d){}}}]);"use strict";
angular.module("jarvis.directives.snapshot",["JarvisApp.services","JarvisApp.directives.files"]).controller("snapshotsCtrl",["$scope","$log","genericScopeService","jarvisWidgetSnapshotService",function(a,b,c,e){c.scope.resources(function(b){a.snapshots=b},function(){return a.snapshots},a,"snapshots",e.snapshot,{name:"snapshot name",icon:"list"})}]).controller("snapshotCtrl",["$scope","$log","$stateParams","$filter","$http","genericResourceService","genericScopeService","jarvisWidgetSnapshotService",
"toastService",function(a,b,c,e,d,f,g,h,k){g.scope.resource(a,"snapshot","snapshots",h.snapshot);a.restore=function(a){void 0!=a&&void 0!=a.id&&""!=a.id&&h.snapshot.task(a.id,"restore",{},function(c){b.debug("snapshotCtrl::restore",a,c)},k.failure)};a.download=function(a){void 0!=a&&void 0!=a.id&&""!=a.id&&h.snapshot.task(a.id,"download",{},function(c){var d="export-"+e("date")(new Date,"yyyyMMdd-HHmmss")+".json",f=document.createElement("a");document.body.appendChild(f);f.style="display: none";b.debug("snapshot",
a,c);c=new Blob([angular.toJson(c,!0)],{type:"application/text"});c=window.URL.createObjectURL(c);f.href=c;f.download=d;f.click()},k.failure)};a.upload=function(a){$("#"+a).trigger("click")};a.loaded=function(a,c){a.json=c.data;b.debug("loaded",a,c)};a.load=function(){a.snapshots=[];f.scope.entity.get(c.id,function(b){a.snapshot=b},h.snapshot);b.info("snapshot-ctrl",a.snapshot)}}]).factory("jarvisWidgetSnapshotService",["genericResourceService",function(a){return{snapshot:a.crud(["snapshots"])}}]).directive("jarvisWidgetSnapshots",
["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/snapshot/jarvis-widget-snapshots.html",link:function(a,b,d){}}}]).directive("jarvisSnapshots",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/snapshot/partials/jarvis-snapshots.html",link:function(a,b,d){}}}]).directive("jarvisWidgetSnapshot",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/snapshot/jarvis-widget-snapshot.html",link:function(a,
b,d){}}}]).directive("jarvisSnapshot",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/snapshot/partials/jarvis-snapshot-general.html",link:function(a,b,d){}}}]);"use strict";
angular.module("jarvis.directives.trigger",["JarvisApp.services"]).controller("jarvisWidgetTriggersCtrl",["$scope","$log","genericScopeService","jarvisWidgetTriggerService",function(a,b,c,e){c.scope.resources(function(b){a.triggers=b},function(){return a.triggers},a,"triggers",e.trigger,{name:"trigger name",icon:"settings_remote"})}]).controller("jarvisWidgetTriggerCtrl",["$scope","$log","$stateParams","genericResourceService","genericScopeService","genericPickerService","jarvisWidgetTriggerService",
"toastService",function(a,b,c,e,d,f,g,h){d.scope.resource(a,"trigger","triggers",g.trigger);a.links={crons:{}};d.scope.resourceLink(function(){return a.crons},a.links.crons,"cron","crons",g.trigger,g.crons,{order:"1"},c.id);a.execute=function(a){g.trigger.task(a.id,"execute",{},function(b){h.info("trigger "+a.name+"#"+a.id+" executed")},h.failure)};a.load=function(){a.activeTab=c.tab;e.scope.entity.get(c.id,function(b){a.trigger=b},g.trigger);a.crons=[];e.scope.collections.findAll("crons",c.id,a.crons,
g.crons);b.info("trigger-ctrl",a.trigger)}}]).factory("jarvisWidgetTriggerService",["genericResourceService",function(a){return{trigger:a.crud(["triggers"]),crons:a.links(["triggers"],["crons"])}}]).directive("jarvisWidgetTriggers",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/trigger/jarvis-widget-triggers.html",link:function(a,b,d){}}}]).directive("jarvisTriggers",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/trigger/partials/jarvis-triggers.html",
link:function(a,b,d){}}}]).directive("jarvisWidgetTrigger",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/trigger/jarvis-widget-trigger.html",link:function(a,b,d){}}}]).directive("jarvisTriggerGeneral",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/trigger/partials/jarvis-trigger-general.html",link:function(a,b,d){}}}]).directive("jarvisTriggerCron",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/trigger/partials/jarvis-trigger-cron.html",
link:function(a,b,d){}}}]).directive("jarvisTriggerLink",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/trigger/partials/jarvis-trigger-link.html",link:function(a,b,d){}}}]);"use strict";
angular.module("jarvis.directives.view",["JarvisApp.services"]).controller("viewsCtrl",["$scope","$log","genericScopeService","jarvisWidgetViewService",function(a,b,c,e){b.info("viewsCtrl");c.scope.resources(function(b){a.views=b},function(){return a.views},a,"views",e.view,{name:"view name",icon:"list"});b.info("views-ctrl",a.views)}]).controller("viewCtrl",["$scope","$log","$stateParams","genericResourceService","genericScopeService","jarvisWidgetViewService","toastService",function(a,b,c,e,d,f,
g){d.scope.resource(a,"view","views",f.view);a.links={devices:{}};d.scope.resourceLink(function(){return a.devices},a.links.devices,"view","views",f.view,f.devices,{order:"1"},c.id);a.load=function(){a.views=[];e.scope.entity.get(c.id,function(b){a.view=b},f.view);a.devices=[];e.scope.collections.findAll("devices",c.id,a.devices,f.devices);b.info("view-ctrl",a.views)}}]).factory("jarvisWidgetViewService",["genericResourceService",function(a){return{view:a.crud(["views"]),devices:a.links(["views"],
["devices"])}}]).directive("jarvisWidgetViews",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/view/jarvis-widget-views.html",link:function(a,b,d){}}}]).directive("jarvisViews",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/view/partials/jarvis-views.html",link:function(a,b,d){}}}]).directive("jarvisWidgetView",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/view/jarvis-widget-view.html",
link:function(a,b,d){}}}]).directive("jarvisViewGeneral",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/view/partials/jarvis-view-general.html",link:function(a,b,d){}}}]);