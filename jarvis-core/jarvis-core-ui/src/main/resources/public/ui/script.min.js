angular.module("JarvisApp","ngMaterial ngMdIcons ngSanitize restangular angular-websocket ui.router ui.router.router pascalprecht.translate ngCookies hljs ui.tree JarvisApp.websocket JarvisApp.config JarvisApp.theme JarvisApp.routes JarvisApp.services JarvisApp.services.filter JarvisApp.services.generic JarvisApp.services.scope JarvisApp.directives.files JarvisApp.directives.widgets jarvis.directives.navigator jarvis.directives.command jarvis.directives.cron jarvis.directives.scenario jarvis.directives.trigger jarvis.directives.configuration jarvis.directives.notification jarvis.directives.connector jarvis.directives.block jarvis.directives.device jarvis.directives.event jarvis.directives.home jarvis.directives.plugin jarvis.directives.property jarvis.directives.snapshot jarvis.directives.view".split(" "));
"use strict";var jarvisServicesUrl="/services",jarvisApiUrl="/api",myAppServices=angular.module("JarvisApp.services",["ngResource"]);
myAppServices.factory("toastService",["$log","$mdToast",function(a,b){a=angular.injector(["ng"]).get("$log");a.info("toastService",b);var e;return e={toastPosition:{bottom:!0,top:!1,left:!1,right:!0},getToastPosition:function(){return Object.keys(e.toastPosition).filter(function(a){return e.toastPosition[a]}).join(" ")},failure:function(d){a.error(d);b.show(b.simple().content(d).position(e.getToastPosition()).hideDelay(3E3).theme("failure-toast"))},info:function(d){a.info(d,e.getToastPosition());
b.show(b.simple().position(e.getToastPosition()).textContent(d).hideDelay(3E3).capsule(!0))}}}]);myAppServices.factory("$store",["$log","$rootScope",function(a,b){a.info("$store");var e={};return{collection:e,push:function(b,c,g){void 0===e[b]&&(e[b]={});a.info("$store",b,c,g);e[b][c]=g},get:function(a,b,g){return void 0==e||void 0==e[a]||void 0==e[a][b]?g:e[a][b]}}}]);
myAppServices.factory("oauth2ResourceService",["$rootScope","$log","$window","$mdDialog","$location","Restangular",function(a,b,e,d,c,g){b=angular.injector(["ng"]).get("$log");return{me:function(a,e,d){b.info("Fix JarvisAuthToken to",a);g.setDefaultHeaders({JarvisAuthToken:a});g.one("/api/profile/me").get().then(function(a){e(a)},function(a){d(a)})},config:function(a,b,e){g.one("oauth2").get(a).then(function(a){b(a)},function(a){e(a)})},connect:function(e,c){b.info("connect with",c);var k=this;k.me(c,
function(c){b.info("profile",c);d.hide();a.profile=c;e.boot()},function(a){b.warn("no profile");k.login()})},login:function(){d.show({controller:"oauth2DialogCtrl",templateUrl:"/ui/js/partials/dialog/oauth2Dialog.tmpl.html",parent:angular.element(document.body),clickOutsideToClose:!1,fullscreen:!1})}}}]);"use strict";myAppServices=angular.module("JarvisApp.services.filter",[]);
myAppServices.factory("filterService",["Restangular",function(a){return{plain:function(b){if(angular.isArray(b)||angular.isObject(b))b=a.stripRestangular(b),delete b.originalElement;return b}}}]);"use strict";
angular.module("JarvisApp.services.generic",["JarvisApp.services.filter"]).factory("genericResourceService",["$log","Restangular","filterService","toastService",function(a,b,e,d){var c={findAll:function(f,d,c){var g=function(b){var c=[];_.forEach(b,function(a){c.push(e.plain(a))});a.debug("[FIND]",f,c);d&&d(c)};1==f.length?b.all("/api/"+f[0]).getList().then(g,function(a){c(a)}):b.all("/api/"+f[0]).all(f[1]).getList().then(g,function(a){c(a)})},get:function(d,c,k,g){var l=function(b){b=e.plain(b);
a.debug("[GET]",d,b);void 0!=k&&k(b)};1==d.length?b.one("/api/"+d[0],c).get().then(l,function(a){g(a)}):b.all("/api/"+d[0]).one(d[1],c).get().then(l,function(a){g(a)})},delete:function(d,c,k,g){var l=function(b){b=e.plain(b);a.debug("[DELETE]",d,b);void 0!=k&&k(b)};1==d.length?b.one("/api/"+d[0],c).remove().then(l,function(a){g(a)}):b.all("/api/"+d[0]).one(d[1],c).remove().then(l,function(a){g(a)})},put:function(d,c,k,g){var l=function(b){b=e.plain(b);a.debug("[PUT]",d,b);void 0!=k&&k(b)};1==d.length?
b.one("/api/"+d[0],c.id).customPUT(c).then(l,function(a){g(a)}):b.all("/api/"+d[0]).one(d[1],c.id).customPUT(c).then(l,function(a){g(a)})},post:function(d,c,k,g){var l=function(b){b=e.plain(b);a.debug("[POST]",d,b);void 0!=k&&k(b)};1==d.length?b.all("/api/"+d[0]).post(c).then(l,function(a){g(a)}):b.all("/api/"+d[0]).all(d[1]).post(c).then(l,function(a){g(a)})},task:function(d,c,k,g,l,m){var q=function(b){var c=e.plain(b);a.debug("[TASK]",b,d,c);void 0!=l&&l(c)};1==d.length?b.all("/api/"+d[0]).one(c).customPOST(g,
"",{task:k}).then(q,function(a){m(a)}):b.all("/api/"+d[0]).all(d[1]).one(c).customPOST(g,"",{task:k}).then(q,function(a){m(a)})}},g={findAll:function(d,c,g,n,l,m){var q=function(b){var m=[];_.forEach(b,function(a){m.push(e.plain(a))});a.debug("[FIND/L/"+g+"]",d,c,n,m);l(m)};1==c.length?1==d.length?b.one("/api/"+d[0],n).all(c[0]).getList({href:g}).then(q,function(a){m(a)}):b.all("/api/"+d[0]).one(d[1],n).all(c[0]).getList({href:g}).then(q,function(a){m(a)}):1==d.length?b.one("/api/"+d[0],n).all(c[0]).all(c[1]).getList({href:g}).then(q,
function(a){m(a)}):b.all("/api/"+d[0]).one(d[1],n).all(c[0]).all(c[1]).getList({href:g}).then(q,function(a){m(a)})},post:function(d,c,g,n,l,m,q,p){var r=function(b){b=e.plain(b);a.debug("[POST/L]",d,b);void 0!=q&&q(b)};void 0!=m&&(m.href=g);1==c.length?1==d.length?b.one("/api/"+d[0],n).one(c[0],l).customPOST(m).then(r,function(a){p(a)}):b.all("/api/"+d[0]).one(d[1],n).one(c[0],l).customPOST(m).then(r,function(a){p(a)}):1==d.length?b.one("/api/"+d[0],n).all(c[0]).one(c[1],l).customPOST(m).then(r,function(a){p(a)}):
b.all("/api/"+d[0]).one(d[1],n).all(c[0]).one(c[1],l).customPOST(m).then(r,function(a){p(a)})},put:function(d,c,g,n,l,m,q,p,r){var t=function(b){b=e.plain(b);a.debug("[PUT/L]",d,b);void 0!=p&&p(b)},s={},s=void 0===q?{}:q;s.href=g;1==c.length?1==d.length?b.one("/api/"+d[0],n).one(c[0],l).one(m).customPUT(s).then(t,function(a){r(a)}):b.all("/api/"+d[0]).one(d[1],n).one(c[0],l).one(m).customPUT(s).then(t,function(a){r(a)}):1==d.length?b.one("/api/"+d[0],n).all(c[0]).one(c[1],l).one(m).customPUT(s).then(t,
function(a){r(a)}):b.all("/api/"+d[0]).one(d[1],n).all(c[0]).one(c[1],l).one(m).customPUT(s).then(t,function(a){r(a)})},delete:function(d,c,g,n,l,m,q,p){var r=function(b){b=e.plain(b);a.debug("[DELETE/L]",d,b);void 0!=q&&q(b)};1==c.length?1==d.length?b.one("/api/"+d[0],n).one(c[0],l).remove({instance:m,href:g}).then(r,function(a){p(a)}):b.all("/api/"+d[0]).one(d[1],n).one(c[0],l).remove({instance:m,href:g}).then(r,function(a){p(a)}):1==d.length?b.one("/api/"+d[0],n).all(c[0]).one(c[1],l).remove({instance:m,
href:g}).then(r,function(a){p(a)}):b.all("/api/"+d[0]).one(d[1],n).all(c[0]).one(c[1],l).remove({instance:m,href:g}).then(r,function(a){p(a)})}};return{crud:function(a){return{findAll:function(b,d){return c.findAll(a,b,d)},get:function(b,d,e){return c.get(a,b,d,e)},delete:function(b,d,e){return c.delete(a,b,d,e)},put:function(b,d,e){return c.put(a,b,d,e)},post:function(b,d,e){return c.post(a,b,d,e)},task:function(b,d,e,g,m){return c.task(a,b,d,e,g,m)}}},links:function(a,b,d){void 0===d&&(d="HREF");
return{findAll:function(c,e,m){return g.findAll(a,b,d,c,e,m)},delete:function(c,e,m,q,p){return g.delete(a,b,d,c,e,m,q,p)},put:function(c,e,m,q,p,r){return g.put(a,b,d,c,e,m,q,p,r)},post:function(c,e,m,q,p){return g.post(a,b,d,c,e,m,q,p)}}},scope:{collections:{new:function(b,c,e,g,l){g.post(e,function(d){a.debug(b+" "+d.name+"#"+d.id+" created");c.push(d);l&&l(d)},d.failure)},findAll:function(b,c,e,g,l){a.debug("loading ",b,g);e.splice(0,e.length);g.findAll(c,function(d){_.forEach(d,function(a){e.push(a)});
a.debug("loaded ",b,e);l&&l(e)},d.failure)}},entity:{get:function(b,c,e){e.get(b,function(b){c(b);a.debug("[GET/scope] "+b.name+"#"+b.id)},d.failure)},remove:function(a,b,c,e){e.delete(c.id,function(e){d.info(b+" "+c.name+"#"+c.id+" removed");a()},d.failure)},save:function(a,b,c){c.put(b,function(c){d.info(a+" "+b.name+"#"+b.id+" updated")},d.failure)},duplicate:function(a,b,c,e){e.post(c,function(e){d.info(b+" "+c.name+"#"+c.id+" duplicated");a()},d.failure)}},link:{add:function(b,c,e,g,l){void 0!=
c&&void 0!=c.id&&""!=c.id&&g.post(b,c.id,e,function(b){a.debug("addLink",b);l.push(b)},d.failure)},save:function(b,c,e){void 0!=c&&void 0!=c.id&&""!=c.id&&e.put(b,c.id,c.instance,c.extended,function(b){a.debug("updateLink - before",c);a.debug("updateLink - after",b)},d.failure)},remove:function(b,c,e,g){void 0!=c&&void 0!=c.id&&""!=c.id&&e.delete(b,c.id,c.instance,function(b){var d=c.instance;_.remove(g,function(a){return a.instance==d});a.debug("removeLink - before",c)},d.failure)}},combo:{findAll:function(b,
c,e){a.debug("loading for select ",b,c);e.findAll(function(a){_.forEach(a,function(a){c.push({id:a.id,name:a.name})})},d.failure)}}}}}]).factory("genericPickerService",["$log","$mdDialog","toastService",function(a,b,e){return{pickers:{confirm:function(a,c,e,f){a=b.confirm().title(a).textContent(c).ariaLabel("Confirm").ok(e).cancel(f);return b.show(a)},nodes:function(a,c,e,f){b.show({controller:f,templateUrl:"js/partials/dialog/nodesDialog.tmpl.html",parent:angular.element(document.body),targetEvent:a,
clickOutsideToClose:!0}).then(function(a){c(a)},function(){e()})},graph:function(a,c,e,f,h){b.show({locals:{anchor:c},bindToController:!0,controller:h,templateUrl:"js/partials/dialog/graphDialog.tmpl.html",targetEvent:a,clickOutsideToClose:!0}).then(function(a){e(a)},function(){f()})}}}}]);"use strict";
angular.module("JarvisApp.services.scope",["JarvisApp.services.generic"]).factory("genericScopeService",["$log","$filter","genericResourceService","genericPickerService","toastService",function(a,b,e,d,c){return{scope:{resources:function(g,f,h,k,n,l){a.debug("inject default resources scope",k,l);h.create=function(a,b){e.scope.collections.new(k,f(),a,n,b)};h.new=function(a){e.scope.collections.new(k,f(),l,n,a)};h.crud=e.crud(k.split("/"));h.remove=function(c,e){d.pickers.confirm(b("translate")("action.drop",
{name:c.name,id:c.id}),"",b("translate")("yes"),b("translate")("no")).then(function(){a.debug("remove",c);var b=c.id;_.remove(f(),function(a){return a.id==b});h.crud.delete(c.id);e&&e(c)},function(){a.debug("abort")})};h.load=function(b){g([]);n.findAll(function(d){g(d);a.debug(k+"-ctrl",d,b);b&&b()},c.failure)}},resource:function(c,f,h,k,n,l,m){a.debug("inject default resource scope",f);c.remove=function(n){d.pickers.confirm(b("translate")("action.drop",{name:n.name,id:n.id}),"",b("translate")("yes"),
b("translate")("no")).then(function(){e.scope.entity.remove(function(){c.go(h)},f,n,k)},function(){a.debug("abort")})};c.save=function(a){e.scope.entity.save(f,a,k)};c.duplicate=function(a){e.scope.entity.duplicate(function(){c.go(h)},f,a,k)}},resourceLink:function(c,f,h,k,n,l,m,q,p){a.debug("inject link",l);f.add=function(b){a.debug("link::add",b);e.scope.link.add(q,b,m,l,c())};f.update=function(b){a.debug("link::update",b);e.scope.link.save(q,b,l)};f.drop=function(f){d.pickers.confirm(b("translate")("action.remove.link",
{name:f.name,id:f.id}),"",b("translate")("yes"),b("translate")("no")).then(function(){a.debug("link::drop",f);p&&p.remove?p.remove(f):e.scope.link.remove(q,f,l,c());p&&p.afterRemove&&p.afterRemove(f)},function(){a.debug("abort")})}}}}}]);"use strict";
angular.module("JarvisApp.config",["JarvisApp.directives.files"]).config(["RestangularProvider",function(a){a.setDefaultHeaders({"content-type":"application/json"});a.setFullRequestInterceptor(function(a,e,d,c,g,f,h){g["content-type"]="application/json";return{element:a,params:f,headers:g,httpConfig:h}});a.setResponseExtractor(function(a){angular.isObject(a)&&(a.originalElement=a);return a})}]).config(["$mdIconProvider",function(a){}]).config(["$translateProvider",function(a){a.useStaticFilesLoader({prefix:"js/l10n/",
suffix:".json"});a.preferredLanguage("fr_FR");a.useSanitizeValueStrategy(null)}]).controller("JarvisAppCtrl",["$rootScope","$scope","$log","$store","$notification","$http","$mdDialog","$mdSidenav","$mdMedia","$location","$window","$state","genericPickerService","toastService","jarvisWidgetDeviceService","jarvisWidgetEventService","jarvisWidgetConfigurationService","oauth2ResourceService",function(a,b,e,d,c,g,f,h,k,n,l,m,q,p,r,t,s,u){b.isJson=function(a){try{JSON.parse(a)}catch(b){return!1}return!0};
b.defaultValue=function(a,b){return void 0===a?b:a};b.loadSettings=function(){s.configuration.findAll(function(a){(a=_.find(a,"active"))?b.config=a:p.failure("No default settings")},p.failure)};b.saveSettings=function(){s.configuration.put(b.config,function(a){e.info("Updated",a)},p.failure)};b.closeSettings=function(){f.hide()};b.settings=function(a){var c=k("sm")||k("xs");f.show({scope:b,preserveScope:!0,templateUrl:"js/partials/dialog/settingsDialog.tmpl.html",parent:angular.element(document.body),
targetEvent:a,clickOutsideToClose:!0,fullscreen:c}).then(function(){e.warn("Saving settings")},function(){e.warn("Cancel settings save")})};b.markdown=new showdown.Converter({tables:"true",ghCodeBlocks:"true"});b.helper=function(a){e.debug("State",m.current.name);g.get("js/helps/fr/"+m.current.name+".markdown").then(function(a){a=b.markdown.makeHtml(a.data);b.help={content:a.replace(/<table>/g,'\x3ctable class\x3d"table table-striped table-bordered table-hover"\x3e')};e.debug("Help",b.help);h("right").toggle()})};
b.toggleSidenav=function(a){h(a).toggle()};b.location=function(a,b){h(a).toggle();n.path(b)};b.go=function(a,b){m.go(a,b)};b.emit=function(a,b){e.debug("JarvisAppCtrl::emit",a,b,a.trigger);t.event.post({trigger:a.trigger,timestamp:(new Date).toISOString(),fired:!0,number:b},function(a){e.debug("JarvisAppCtrl::emit",a);p.info("event "+a.trigger+"#"+a.id+" emitted")},p.failure)};b.execute=function(a){r.device.task(a.id,"execute",{},function(a){e.debug("JarvisAppCtrl::execute",a);b.renderdata=a},p.failure)};
b.graph=function(a,b){return q.pickers.graph(a,b,function(a){e.debug("Go")},function(){e.debug("Abort")},"graphDialogCtrl")};b.$watch(function(a,b,c){return d.collection},function(a,c,d){b.store=a});b.boot=function(){b.config={};b.version={angular:angular.version,angularmd:window.ngMaterial};e.info("JarvisAppCtrl",b.version);b.media=k("xs");b.$watch(function(){return k("xs")},function(a){a&&(b.media="xs")});b.$watch(function(){return k("gt-xs")},function(a){a&&(b.media="gt-xs")});b.$watch(function(){return k("sm")},
function(a){a&&(b.media="sm")});b.$watch(function(){return k("gt-sm")},function(a){a&&(b.media="gt-sm")});b.$watch(function(){return k("md")},function(a){a&&(b.media="md")});b.$watch(function(){return k("gt-md")},function(a){a&&(b.media="gt-md")});b.$watch(function(){return k("lg")},function(a){a&&(b.media="lg")});b.$watch(function(){return k("gt-lg")},function(a){a&&(b.media="gt-lg")});b.$watch(function(){return k("xl")},function(a){a&&(b.media="xl")});b.$watch(function(){return k("print")},function(a){a&&
(b.media="print")});hljs.initHighlightingOnLoad();b.loadSettings();e.info("JarvisAppCtrl configured")};u.connect(b)}]).controller("extractTokenCtrl",["$scope","$log","$location","$rootScope","$state","oauth2ResourceService",function(a,b,e,d,c,g){b.warn("extractTokenCtrl",c);b=e.path().substr(1).split("\x26");d={};for(c=0;c<b.length;c++){var f=b[c].split("\x3d"),h=f[0];d[h]=f[1];"access_token"===h&&(g.connect(a,d.access_token),e.path("/home"))}}]).controller("oauth2DialogCtrl",["$scope","$window",
"$log","$mdDialog","oauth2ResourceService",function(a,b,e,d,c){a.hide=function(){d.hide()};a.cancel=function(){d.cancel()};a.answer=function(a){c.config({client:a.client,oauth2_redirect_uri:b.location.href.split("#")[0]},function(a){e.info("JarvisAppCtrl configured with",a);b.location.href=a.url},function(a){e.warn("no oauth2 configuration",a)});d.hide()}}]).controller("graphDialogCtrl",["$scope","$log","$mdDialog",function(a,b,e){b.info("graphDialogCtrl");a.hide=function(){e.hide()};a.cancel=function(){e.cancel()};
a.answer=function(a){e.hide(a)}}]).controller("pickPluginDialogCtrl",["$scope","$log","$mdDialog","genericResourceService","toastService",function(a,b,e,d,c){b.info("pickPluginDialogCtrl");a.hide=function(){e.hide()};a.cancel=function(){e.cancel()};a.answer=function(a){e.hide(a)};a.elementsPicker=[{name:"Connected Objects",selectable:!1,nodes:[]},{name:"Plugin Scripts",selectable:!1,nodes:[]}];a.crudDevice=d.crud(["devices"]);a.crudDevice.findAll(function(b){_.each(b,function(b){b.selectable=!1;a.elementsPicker[0].nodes.push(b)})},
c.failure);a.crudScript=d.crud(["plugins","scripts"]);a.crudScript.findAll(function(b){_.each(b,function(b){b.selectable=!0;a.elementsPicker[1].nodes.push(b)})},c.failure)}]).controller("pickDeviceDialogCtrl",["$scope","$log","$mdDialog","genericResourceService","toastService",function(a,b,e,d,c){b.info("pickDeviceDialogCtrl");a.hide=function(){e.hide()};a.cancel=function(){e.cancel()};a.answer=function(a){e.hide(a)};a.elementsPicker=[{name:"Connected Objects",selectable:!1,nodes:[]},{name:"Plugin Scripts",
selectable:!1,nodes:[]}];a.crudDevice=d.crud(["devices"]);a.crudDevice.findAll(function(b){_.each(b,function(b){b.selectable=!0;a.elementsPicker[0].nodes.push(b)})},c.failure);a.crudScript=d.crud(["plugins","scripts"]);a.crudScript.findAll(function(b){_.each(b,function(b){b.selectable=!1;a.elementsPicker[1].nodes.push(b)})},c.failure)}]).controller("pickCommandDialogCtrl",["$scope","$log","$mdDialog","genericResourceService","toastService",function(a,b,e,d,c){b.info("pickCommandDialogCtrl");a.hide=
function(){e.hide()};a.cancel=function(){e.cancel()};a.answer=function(a){e.hide(a)};a.elementsPicker=[{name:"Commands",selectable:!1,nodes:[]}];a.crud=d.crud(["commands"]);a.crud.findAll(function(b){_.each(b,function(b){b.selectable=!0;a.elementsPicker[0].nodes.push(b)})},c.failure)}]).controller("pickTriggerDialogCtrl",["$scope","$log","$mdDialog","genericResourceService","toastService",function(a,b,e,d,c){b.info("pickTriggerDialogCtrl");a.hide=function(){e.hide()};a.cancel=function(){e.cancel()};
a.answer=function(a){e.hide(a)};a.elementsPicker=[{name:"Triggers",selectable:!1,nodes:[]}];a.crud=d.crud(["triggers"]);a.crud.findAll(function(b){_.each(b,function(b){b.selectable=!0;a.elementsPicker[0].nodes.push(b)})},c.failure)}]).controller("pickNotificationDialogCtrl",["$scope","$log","$mdDialog","genericResourceService","toastService",function(a,b,e,d,c){b.info("pickNotificationDialogCtrl");a.hide=function(){e.hide()};a.cancel=function(){e.cancel()};a.answer=function(a){e.hide(a)};a.elementsPicker=
[{name:"Notifications",selectable:!1,nodes:[]}];a.crud=d.crud(["notifications"]);a.crud.findAll(function(b){_.each(b,function(b){b.selectable=!0;a.elementsPicker[0].nodes.push(b)})},c.failure)}]).controller("pickCronDialogCtrl",["$scope","$log","$mdDialog","genericResourceService","toastService",function(a,b,e,d,c){b.info("pickCronDialogCtrl");a.hide=function(){e.hide()};a.cancel=function(){e.cancel()};a.answer=function(a){e.hide(a)};a.elementsPicker=[{name:"Crontab objects",selectable:!1,nodes:[]}];
a.crud=d.crud(["crons"]);a.crud.findAll(function(b){_.each(b,function(b){b.selectable=!0;a.elementsPicker[0].nodes.push(b)})},c.failure)}]).controller("pickBlockDialogCtrl",["$scope","$log","$mdDialog","genericResourceService","toastService",function(a,b,e,d,c){b.info("pickBlockDialogCtrl");a.hide=function(){e.hide()};a.cancel=function(){e.cancel()};a.answer=function(a){e.hide(a)};a.elementsPicker=[{name:"Blocks",selectable:!1,nodes:[]}];a.crudBlock=d.crud(["blocks"]);a.crudBlock.findAll(function(b){_.each(b,
function(b){b.selectable=!0;a.elementsPicker[0].nodes.push(b)})},c.failure)}]);"use strict";
angular.module("JarvisApp.directives.files",[]).directive("appVersion",function(a){return function(b,e,d){e.text(a)}}).directive("fileModel",["$parse","$log",function(a,b){return{restrict:"A",link:function(b,d,c){var g=a(c.fileModel).assign;d.bind("change",function(){b.$apply(function(){g(b,d[0].files[0])})})}}}]).directive("fileSelect",["$window","$log",function(a,b){return{restrict:"A",require:"ngModel",link:function(e,d,c,g){var f=new a.FileReader;f.onload=function(){b.info("fileSelect.onload");
var a=f.result.substr(f.result.lastIndexOf(",")+1);b.debug("result:",f.result);b.debug("result base64 value:",a);g.$setViewValue(atob(a));"fileLoaded"in c&&e.$eval(c.fileLoaded)};f.onprogress=function(a){"fileProgress"in c&&e.$eval(c.fileProgress,{$total:a.total,$loaded:a.loaded})};f.onerror=function(){"fileError"in c&&e.$eval(c.fileError,{$error:f.error})};var h=c.fileSelect;d.bind("change",function(a){b.info("fileSelect.change");a=a.target.files[0];""===h||"text"===h?f.readAsText(a,"UTF-8"):"data"===
h&&f.readAsDataURL(a)})}}}]);"use strict";angular.module("JarvisApp.filters",[]).filter("interpolate",["version",function(a){return function(b){return String(b).replace(/\%VERSION\%/mg,a)}}]);"use strict";
angular.module("JarvisApp.routes",["JarvisApp.config"]).config(["$urlRouterProvider",function(a){a.otherwise("/home")}]).config(["$stateProvider",function(a){a.state("token_access",{url:"/access_token\x3d:accesToken",controller:"extractTokenCtrl",template:""}).state("helper-devices",{url:"/helper-devices",params:{resources:["crons","triggers","devices","plugins","commands"]},controller:"jarvisWidgetNavigatorCtrl",template:"\x3cjarvis-widget-navigator\x3e\x3c/jarvis-widget-navigator\x3e"}).state("helper-scenarii",
{url:"/helper-scenarii",params:{resources:["triggers","crons","scenarios","blocks","plugins"]},controller:"jarvisWidgetNavigatorCtrl",template:"\x3cjarvis-widget-navigator\x3e\x3c/jarvis-widget-navigator\x3e"}).state("helper-system",{url:"/helper-system",params:{resources:["configurations","notifications","properties","connectors","views"]},controller:"jarvisWidgetNavigatorCtrl",template:"\x3cjarvis-widget-navigator\x3e\x3c/jarvis-widget-navigator\x3e"}).state("home",{url:"/home",controller:"jarvisWidgetHomeCtrl",
template:"\x3cjarvis-widget-home\x3e\x3c/jarvis-widget-home\x3e"}).state("events",{url:"/events",controller:"jarvisWidgetEventsCtrl",template:"\x3cjarvis-widget-event\x3e\x3c/jarvis-widget-event\x3e"}).state("triggers",{url:"/triggers",controller:"jarvisWidgetTriggersCtrl",template:"\x3cjarvis-widget-triggers\x3e\x3c/jarvis-widget-triggers\x3e"}).state("triggers-by-id",{url:"/triggers/:id?tab",controller:"jarvisWidgetTriggerCtrl",template:"\x3cjarvis-widget-trigger\x3e\x3c/jarvis-widget-trigger\x3e"}).state("notifications",
{url:"/notifications",controller:"notificationsCtrl",template:"\x3cjarvis-widget-notifications\x3e\x3c/jarvis-widget-notifications\x3e"}).state("notifications-by-id",{url:"/notifications/:id?tab",controller:"notificationCtrl",template:"\x3cjarvis-widget-notification\x3e\x3c/jarvis-widget-notification\x3e"}).state("devices",{url:"/devices",controller:"devicesCtrl",template:"\x3cjarvis-widget-devices\x3e\x3c/jarvis-widget-devices\x3e"}).state("devices-by-id",{url:"/devices/:id?tab",controller:"deviceCtrl",
template:"\x3cjarvis-widget-device\x3e\x3c/jarvis-widget-device\x3e"}).state("plugins",{url:"/plugins",controller:"pluginsCtrl",template:"\x3cjarvis-widget-plugins\x3e\x3c/jarvis-widget-plugins\x3e"}).state("plugins-by-id-script",{url:"/plugins/scripts/:id?tab",controller:"pluginScriptCtrl",template:"\x3cjarvis-widget-plugin\x3e\x3c/jarvis-widget-plugin\x3e"}).state("commands",{url:"/commands",controller:"commandsCtrl",template:"\x3cjarvis-widget-commands\x3e\x3c/jarvis-widget-commands\x3e"}).state("commands-by-id",
{url:"/commands/:id?tab",controller:"commandCtrl",template:"\x3cjarvis-widget-command\x3e\x3c/jarvis-widget-command\x3e"}).state("views",{url:"/views",controller:"viewsCtrl",template:"\x3cjarvis-widget-views\x3e\x3c/jarvis-widget-views\x3e"}).state("views-by-id",{url:"/views/:id?tab",controller:"viewCtrl",template:"\x3cjarvis-widget-view\x3e\x3c/jarvis-widget-view\x3e"}).state("configurations",{url:"/configurations",controller:"configurationsCtrl",template:"\x3cjarvis-widget-configurations\x3e\x3c/jarvis-widget-configurations\x3e"}).state("configurations-by-id",
{url:"/configurations/:id?tab",controller:"configurationCtrl",template:"\x3cjarvis-widget-configuration\x3e\x3c/jarvis-widget-configuration\x3e"}).state("properties",{url:"/properties",controller:"propertiesCtrl",template:"\x3cjarvis-widget-properties\x3e\x3c/jarvis-widget-properties\x3e"}).state("properties-by-id",{url:"/properties/:id?tab",controller:"propertyCtrl",template:"\x3cjarvis-widget-property\x3e\x3c/jarvis-widget-property\x3e"}).state("connectors",{url:"/connectors",controller:"connectorsCtrl",
template:"\x3cjarvis-widget-connectors\x3e\x3c/jarvis-widget-connectors\x3e"}).state("connectors-by-id",{url:"/connectors/:id?tab",controller:"connectorCtrl",template:"\x3cjarvis-widget-connector\x3e\x3c/jarvis-widget-connector\x3e"}).state("snapshots",{url:"/snapshots",controller:"snapshotsCtrl",template:"\x3cjarvis-widget-snapshots\x3e\x3c/jarvis-widget-snapshots\x3e"}).state("snapshots-by-id",{url:"/snapshots/:id?tab",controller:"snapshotCtrl",template:"\x3cjarvis-widget-snapshot\x3e\x3c/jarvis-widget-snapshot\x3e"}).state("crons",
{url:"/crons",controller:"cronsCtrl",template:"\x3cjarvis-widget-crons\x3e\x3c/jarvis-widget-crons\x3e"}).state("crons-by-id",{url:"/crons/:id?tab",controller:"cronCtrl",template:"\x3cjarvis-widget-cron\x3e\x3c/jarvis-widget-cron\x3e"}).state("scenarios",{url:"/scenarios",controller:"scenariosCtrl",template:"\x3cjarvis-widget-scenarios\x3e\x3c/jarvis-widget-scenarios\x3e"}).state("scenarios-by-id",{url:"/scenarios/:id?tab",controller:"scenarioCtrl",template:"\x3cjarvis-widget-scenario\x3e\x3c/jarvis-widget-scenario\x3e"}).state("blocks",
{url:"/blocks",controller:"blocksCtrl",template:"\x3cjarvis-widget-blocks\x3e\x3c/jarvis-widget-blocks\x3e"}).state("blocks-by-id",{url:"/blocks/:id?tab",controller:"blockCtrl",template:"\x3cjarvis-widget-block\x3e\x3c/jarvis-widget-block\x3e"})}]);"use strict";
angular.module("JarvisApp.theme",["ngMaterial"]).config(["$mdThemingProvider",function(a){a.alwaysWatchTheme(!0);a.definePalette("customPrimary",{50:"#aaeafd",100:"#92e4fc",200:"#79defc",300:"#60d8fb",400:"#47d2fb",500:"#2ECCFA",600:"#15c6f9",700:"#06bbef",800:"#05a7d6",900:"#0594bd",A100:"#c3f0fe",A200:"#dcf7fe",A400:"#f5fdff",A700:"#0480a5"});a.definePalette("customAccent",{50:"#ffffff",100:"#ffffff",200:"#ffffff",300:"#f8fcfe",400:"#e3f4f9",500:"#CEECF5",600:"#b9e4f1",700:"#a4dcec",800:"#8ed3e8",
900:"#79cbe4",A100:"#ffffff",A200:"#ffffff",A400:"#ffffff",A700:"#64c3df"});a.definePalette("customWarn",{50:"#ff8080",100:"#ff6666",200:"#ff4d4d",300:"#ff3333",400:"#ff1a1a",500:"#FF0000",600:"#e60000",700:"#cc0000",800:"#b30000",900:"#990000",A100:"#ff9999",A200:"#ffb3b3",A400:"#ffcccc",A700:"#800000"});a.definePalette("customBackground",{50:"#ffffff",100:"#ffffff",200:"#ffffff",300:"#ffffff",400:"#ffffff",500:"#F2F2F2",600:"#e5e5e5",700:"#d8d8d8",800:"#cccccc",900:"#bfbfbf",A100:"#ffffff",A200:"#ffffff",
A400:"#ffffff",A700:"#b2b2b2"});a.theme("default").primaryPalette("customPrimary").accentPalette("customAccent").warnPalette("customWarn").backgroundPalette("customBackground")}]);"use strict";
angular.module("JarvisApp.websocket",["angular-websocket"]).factory("$notification",["$store","$log","$websocket","$window",function(a,b,e,d){b.info("$notification",d.location);b=e("ws://"+d.location.hostname+":"+d.location.port+"/stream/");b.onMessage(function(b){b=JSON.parse(b.data);a.push(b.classname,b.instance,b.data)});return{dataStream:b}}]);"use strict";
angular.module("JarvisApp.directives.widgets",["JarvisApp.services"]).directive("jarvisDefaultMenuBar",["$log","$parse",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/widget/tools/jarvis-default-menu-bar.html",require:"ngModel",link:function(a,b,c,g){a.closeMenu=c.close;a.element=function(){return g.$viewValue}}}}]).directive("jarvisPickElement",["$log","$parse","genericPickerService",function(a,b,e){return{restrict:"E",template:'\x3cmd-button aria-label\x3d"menu" class\x3d"md-icon-button" ng-click\x3d"pickItemDialog($event)"\x3e\x3cmd-tooltip\x3e{{pick.tooltips|translate}}\x3c/md-tooltip\x3e\x3cmd-icon md-font-icon\x3d"material-icons md-16"\x3e{{pick.icon}}\x3c/md-icon\x3e\x3c/md-button\x3e',
scope:{},link:function(d,c,g,f){d.pick={};d.pick.tooltips=g.tooltips;d.pick.icon=g.icon;d.pick.tooltips=g.tooltips;d.pick.ctrl=g.ctrl;d.pick.callback=g.callback;d.pickItemDialog=function(c,g){return e.pickers.nodes(c,function(a){b(d.pick.callback)(d.$parent)(a)},function(){a.debug("no picked element")},d.pick.ctrl)}}}}]).directive("typecommand",["$log",function(a){return{require:"ngModel",link:function(a,e,d,c){c.$validators.typecommand=function(a,b){return c.$isEmpty(a)?!1:"data"==a||"action"==a?
!0:!1}}}}]).directive("naturecommand",["$log",function(a){return{require:"ngModel",link:function(a,e,d,c){c.$validators.naturecommand=function(a,b){return c.$isEmpty(a)?!1:"text"==a||"json"==a||"xml"==a?!0:!1}}}}]).directive("jarvisCard",["$log","$parse",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/widget/tile/jarvis-card.html",scope:!1,link:function(e,d,c){a.debug("jarvis-card element",b(c.element)(e));a.debug("jarvis-card state",b(c.state)(e));e.element=b(c.element)(e);e.state=
b(c.state)(e)}}}]).directive("jarvisTile",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/widget/tile/jarvis-tile.html",link:function(b,d,c){a.debug("jarvis-tile")}}}]).directive("jarvisTileBoolean",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/widget/tile/jarvis-tile-boolean.html",link:function(b,d,c){a.debug("jarvis-tile-boolean")}}}]).directive("jarvisTileInt",["$log","$stateParams",function(a,b){return{restrict:"E",
templateUrl:"/ui/js/partials/widget/tile/jarvis-tile-int.html",link:function(b,d,c){a.debug("jarvis-tile-int")}}}]).directive("jarvisTilePercent",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/widget/tile/jarvis-tile-percent.html",link:function(b,d,c){a.debug("jarvis-tile-percent")}}}]).directive("jarvisInlineTemplate",["$log","$stateParams","$parse",function(a,b,e){return{restrict:"E",template:'\x3cdiv ng-include\x3d"getJarvisInlineTemplateUrl()"\x3e\x3c/div\x3e',
link:function(b,c,g){a.debug("jarvis-inline-template id",e(g.id)(b));b.getJarvisInlineTemplateUrl=function(){b.data=e(g.data)(b);return"/api/directives/html/devices/"+e(g.id)(b)}}}}]).directive("jarvisGauge",["$log","$store","$notification",function(a,b,e){return{restrict:"AC",controller:["$scope","$element","$attrs",function(d,c,e){a.debug("jarvis-gauge",e.id);d.gauge=(new Gauge(document.getElementById(e.id))).setOptions({fontSize:10,lines:10,angle:0,lineWidth:.32,pointer:{length:.9,strokeWidth:.035,
color:"#000000"},limitMax:"false",colorStart:"#6FADCF",colorStop:"#8FC0DA",strokeColor:"#E0E0E0",generateGradient:!0});d.gauge.maxValue=100;d.gauge.animationSpeed=10;d.gauge.set(0);d.$watch(function(){return 100*b.get("SystemIndicator","1",0).systemCpuLoad},function(a,b,c){d.gauge.set(a)})}]}}]);"use strict";
angular.module("jarvis.directives.block",["JarvisApp.services"]).controller("blocksCtrl",["$scope","$log","genericScopeService","genericPickerService","jarvisWidgetBlockService","toastService",function(a,b,e,d,c,g){b.debug("blocks-ctrl",a.blocks);e.scope.resources(function(b){a.blocks=b},function(){return a.blocks},a,"blocks",c.block,{name:"block name",icon:"list",parameter:"{}"});b.debug("blocks-ctrl",a.blocks)}]).controller("blockCtrl",["$scope","$log","$stateParams","genericScopeService","genericResourceService",
"genericPickerService","jarvisWidgetBlockService","toastService",function(a,b,e,d,c,g,f,h){d.scope.resource(a,"block","blocks",f.block);a.links={plugins:{"if":{},then:{},"else":{}},blocks:{then:{},"else":{}}};d.scope.resourceLink(function(){return a.plugins.if},a.links.plugins.if,"block","blocks",f.block,f.plugins.if,{order:"1"},e.id);d.scope.resourceLink(function(){return a.plugins.then},a.links.plugins.then,"block","blocks",f.block,f.plugins.then,{order:"1"},e.id);d.scope.resourceLink(function(){return a.plugins.else},
a.links.plugins.else,"block","blocks",f.block,f.plugins.else,{order:"1"},e.id);d.scope.resourceLink(function(){return a.blocks.then},a.links.blocks.then,"block","blocks",f.block,f.blocks.then,{order:"1"},e.id);d.scope.resourceLink(function(){return a.blocks.else},a.links.blocks.else,"block","blocks",f.block,f.blocks.else,{order:"1"},e.id);a.test=function(b){void 0!=b&&void 0!=b.id&&""!=b.id&&f.block.task(b.id,"test",{},function(b){a.testExpression="true"==b},h.failure)};a.execute=function(c){void 0!=
c&&void 0!=c.id&&""!=c.id&&f.block.task(c.id,"execute",{},function(d){b.debug("[BLOCK/test]",c,d);a.testExpression=d},h.failure)};a.load=function(){a.activeTab=e.tab;c.scope.entity.get(e.id,function(b){a.block=b},f.block);a.plugins={if:{},then:{},else:{}};a.plugins.if=[];c.scope.collections.findAll("plugins.if",e.id,a.plugins.if,f.plugins.if);a.plugins.then=[];c.scope.collections.findAll("plugins.then",e.id,a.plugins.then,f.plugins.then);a.plugins.else=[];c.scope.collections.findAll("plugins.else",
e.id,a.plugins.else,f.plugins.else);a.blocks={then:{},else:{}};a.blocks.then=[];c.scope.collections.findAll("blocks.then",e.id,a.blocks.then,f.blocks.then);a.blocks.else=[];c.scope.collections.findAll("blocks.else",e.id,a.blocks.else,f.blocks.else);b.debug("block-ctrl",a.block);b.debug("block-ctrl",a.blocks)}}]).factory("jarvisWidgetBlockService",["genericResourceService",function(a){return{block:a.crud(["blocks"]),plugins:{"if":a.links(["blocks"],["plugins","scripts"],"HREF_IF"),then:a.links(["blocks"],
["plugins","scripts"],"HREF_THEN"),"else":a.links(["blocks"],["plugins","scripts"],"HREF_ELSE")},blocks:{then:a.links(["blocks"],["blocks"],"HREF_THEN"),"else":a.links(["blocks"],["blocks"],"HREF_ELSE")}}}]).directive("jarvisWidgetBlocks",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/block/jarvis-widget-blocks.html",link:function(a,b,c){}}}]).directive("jarvisBlocks",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/block/partials/jarvis-blocks.html",
link:function(a,b,c){}}}]).directive("jarvisWidgetBlock",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/block/jarvis-widget-block.html",link:function(a,b,c){}}}]).directive("jarvisBlockGeneral",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/block/partials/jarvis-block-general.html",link:function(a,b,c){}}}]).directive("jarvisBlockElse",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/block/partials/jarvis-block-else.html",
link:function(a,b,c){}}}]).directive("jarvisBlockThen",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/block/partials/jarvis-block-then.html",link:function(a,b,c){}}}]);
angular.module("jarvis.directives.command",["JarvisApp.services"]).controller("commandsCtrl",["$scope","$log","genericScopeService","jarvisWidgetCommandService",function(a,b,e,d){e.scope.resources(function(b){a.commands=b},function(){return a.commands},a,"commands",d.command,{name:"command name",icon:"list"})}]).controller("commandCtrl",["$scope","$log","$stateParams","genericResourceService","genericScopeService","jarvisWidgetCommandService","toastService",function(a,b,e,d,c,g,f){c.scope.resource(a,
"command","commands",g.command);a.links={notifications:{}};c.scope.resourceLink(function(){return a.notifications},a.links.notifications,"notification","notifications",g.command,g.notifications,{order:"1"},e.id);a.execute=function(b){jarvisWidgetCommandService.command.task(b.id,"execute",a.rawTestData,function(c){f.info("command "+b.name+"#"+b.id+" executed");a.output=angular.toJson(c,!0)},f.failure)};a.test=function(b){jarvisWidgetCommandService.command.task(b.id,"test",a.rawTestData,function(c){f.info("command "+
b.name+"#"+b.id+" tested");a.output=angular.toJson(c,!0)},f.failure)};a.pretty=function(){b.debug("pretty",a.rawinput);a.jsonTestData=angular.toJson(a.rawTestData,!0)};a.submit=function(){a.rawTestData=angular.fromJson(a.editTestData);a.jsonTestData=angular.toJson(a.rawTestData,!0)};a.clear=function(){a.rawTestData={"default":"todo"};a.editTestData=angular.toJson(a.rawTestData,!0);a.jsonTestData=angular.toJson(a.rawTestData,!0);a.rawoutput={};a.output=angular.toJson({},!0)};a.load=function(){a.combo=
{visibles:g.bool,types:g.types};a.clear();a.commands=[];d.scope.entity.get(e.id,function(b){a.command=b},g.command);a.notifications=[];d.scope.collections.findAll("notifications",e.id,a.notifications,g.notifications);b.info("command-ctrl")}}]).factory("jarvisWidgetCommandService",["genericResourceService",function(a){return{command:a.crud(["commands"]),notifications:a.links(["commands"],["notifications"]),bool:[{id:!0,value:"common.true"},{id:!1,value:"common.false"}],types:[{id:"SHELL",value:"command.shell"},
{id:"COMMAND",value:"command.single"},{id:"GROOVY",value:"command.groovy"},{id:"SSH",value:"command.ssh"},{id:"ZWAY",value:"command.zway"}]}}]).directive("jarvisWidgetCommands",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/command/jarvis-widget-commands.html",link:function(a,b,c){}}}]).directive("jarvisCommands",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/command/partials/jarvis-commands.html",link:function(a,b,
c){}}}]).directive("jarvisWidgetCommand",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/command/jarvis-widget-command.html",link:function(a,b,c){}}}]).directive("jarvisCommand",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/command/partials/jarvis-command-general.html",link:function(b,d,c){a.debug("jarvis-command")}}}]).directive("jarvisCommandNotification",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/command/partials/jarvis-command-notification.html",
link:function(b,d,c){a.debug("jarvis-command-notification")}}}]).directive("jarvisCommandInput",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/command/partials/jarvis-command-input.html",link:function(b,d,c){a.debug("jarvis-command-input")}}}]).directive("jarvisCommandScript",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/command/partials/jarvis-command-script.html",link:function(b,d,c){a.debug("jarvis-command-script")}}}]).directive("jarvisCommandOutput",
["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/command/partials/jarvis-command-output.html",link:function(b,d,c){a.debug("jarvis-command-output")}}}]);"use strict";
angular.module("jarvis.directives.configuration",["JarvisApp.services"]).controller("configurationsCtrl",["$scope","$log","genericScopeService","jarvisWidgetConfigurationService",function(a,b,e,d){e.scope.resources(function(b){a.configurations=b},function(){return a.configurations},a,"configurations",d.configuration,{name:"default",opacity:"1",backgroundUrl:"http://artroyalephotography.com/wp-content/uploads/2011/08/minimal-gray-to-white-gradient-wallpapers_33797_1920x1200-1024x640.jpg"})}]).controller("configurationCtrl",
["$scope","$log","$stateParams","$mdDialog","genericResourceService","genericScopeService","jarvisWidgetConfigurationService","toastService",function(a,b,e,d,c,g,f,h){g.scope.resource(a,"configuration","configurations",f.configuration);a.load=function(){c.scope.entity.get(e.id,function(b){a.config=b},f.configuration);b.info("configuration-ctrl",a.configurations)}}]).factory("jarvisWidgetConfigurationService",["genericResourceService",function(a){return{configuration:a.crud(["configurations"])}}]).directive("jarvisWidgetConfigurations",
["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/configuration/jarvis-widget-configurations.html",link:function(a,b,c){}}}]).directive("jarvisConfigurations",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/configuration/partials/jarvis-configurations.html",link:function(b,d,c){a.debug("jarvis-configurations")}}}]).directive("jarvisWidgetConfiguration",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/configuration/jarvis-widget-configuration.html",
link:function(a,b,c){}}}]).directive("jarvisConfiguration",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/configuration/partials/jarvis-configuration-general.html",link:function(b,d,c){a.debug("jarvis-configuration")}}}]).directive("jarvisConfigurationSystem",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/configuration/partials/jarvis-configuration-system.html",link:function(b,d,c){a.debug("jarvis-configuration-system")}}}]);
"use strict";
angular.module("jarvis.directives.connector",["JarvisApp.services"]).controller("connectorsCtrl",["$scope","$log","genericScopeService","jarvisWidgetConnectorService",function(a,b,e,d){e.scope.resources(function(b){a.connectors=b},function(){return a.connectors},a,"connectors",d.connector,{name:"connector name",icon:"settings_input_antenna",isRenderer:!1,isSensor:!1,canAnswer:!1})}]).controller("connectorCtrl",["$scope","$log","$stateParams","$mdDialog","genericResourceService","genericScopeService","jarvisWidgetConnectorService",
"toastService",function(a,b,e,d,c,g,f,h){g.scope.resource(a,"connector","connectors",f.connector);a.ping=function(b){f.connector.task(b.id,"ping",b,function(b){a.status=angular.toJson(b,!0)},h.failure)};a.load=function(){c.scope.entity.get(e.id,function(b){a.connector=b},f.connector);b.info("connector-ctrl",a.connectors)}}]).factory("jarvisWidgetConnectorService",["genericResourceService",function(a){return{connector:a.crud(["connectors"])}}]).directive("jarvisWidgetConnectors",["$log","$stateParams",
function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/connector/jarvis-widget-connectors.html",link:function(a,b,c){}}}]).directive("jarvisConnectors",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/connector/partials/jarvis-connectors.html",link:function(a,b,c){}}}]).directive("jarvisWidgetConnector",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/connector/jarvis-widget-connector.html",link:function(a,b,c){}}}]).directive("jarvisConnectorGeneral",
["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/connector/partials/jarvis-connector-general.html",link:function(a,b,c){}}}]);"use strict";
angular.module("jarvis.directives.cron",["JarvisApp.services"]).controller("cronsCtrl",["$scope","$log","genericScopeService","jarvisWidgetCronService","toastService",function(a,b,e,d,c){e.scope.resources(function(b){a.crons=b},function(){return a.crons},a,"crons",d.cron,{name:"cron name",icon:"list",cron:"* * * * *"});a.start=function(){_.each(a.crons,function(a){d.cron.task(a.id,"toggle",{target:!0},function(a){c.info("crontab "+crontab.name+"#"+crontab.id+" toggled to "+crontab.status)},c.failure)})};
a.stop=function(){_.each(a.crons,function(a){d.cron.task(a.id,"toggle",{target:!1},function(a){c.info("crontab "+crontab.name+"#"+crontab.id+" toggled to "+crontab.status)},c.failure)})}}]).controller("cronCtrl",["$scope","$log","$stateParams","$filter","$http","genericResourceService","genericScopeService","jarvisWidgetCronService","toastService",function(a,b,e,d,c,g,f,h,k){f.scope.resource(a,"cron","crons",h.cron);a.toggle=function(a){b.info(a);h.cron.task(a.id,"toggle",{},function(a){k.info("crontab "+
crontab.name+"#"+crontab.id+" toggled to "+crontab.status)},k.failure)};a.test=function(a){b.info(a);h.cron.task(a.id,"test",{},function(a){k.info("crontab "+crontab.name+"#"+crontab.id+" toggled to "+crontab.status)},k.failure)};a.load=function(){a.crons=[];g.scope.entity.get(e.id,function(b){a.cron=b},h.cron);b.info("cron-ctrl",a.crons)}}]).factory("jarvisWidgetCronService",["genericResourceService",function(a){return{cron:a.crud(["crons"])}}]).directive("jarvisWidgetCrons",["$log","$stateParams",
function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/cron/jarvis-widget-crons.html",link:function(a,b,c){}}}]).directive("jarvisCrons",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/cron/partials/jarvis-crons.html",link:function(a,b,c){}}}]).directive("jarvisWidgetCron",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/cron/jarvis-widget-cron.html",link:function(a,b,c){}}}]).directive("jarvisCron",["$log","$stateParams",
function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/cron/partials/jarvis-cron-general.html",link:function(b,d,c){a.debug("jarvis-command")}}}]);"use strict";
angular.module("jarvis.directives.device",["JarvisApp.services"]).controller("devicesCtrl",["$scope","$log","genericScopeService","jarvisWidgetDeviceService",function(a,b,e,d){e.scope.resources(function(b){a.devices=b},function(){return a.devices},a,"devices",d.device,{name:"object name",icon:"list"})}]).controller("deviceCtrl",["$scope","$log","$state","$stateParams","jarvisWidgetDeviceService","genericScopeService","genericResourceService","toastService",function(a,b,e,d,c,g,f,h){a.getLink=function(){return a.plugins};
g.scope.resource(a,"device","devices",c.device);a.links={plugins:{},triggers:{},devices:{}};g.scope.resourceLink(function(){return a.plugins},a.links.plugins,"device","devices",c.device,c.plugins,{order:"1"},d.id);g.scope.resourceLink(function(){return a.triggers},a.links.triggers,"device","devices",c.device,c.triggers,{order:"1"},d.id);g.scope.resourceLink(function(){return a.devices},a.links.devices,"device","devices",c.device,c.devices,{order:"1"},d.id);a.render=function(d){c.device.task(d.id,
"render",{},function(c){b.debug("deviceCtrl::render",c);a.renderdata=c;a.output=angular.toJson(c,!0)},h.failure)};a.load=function(){a.activeTab=d.tab;f.scope.entity.get(d.id,function(b){a.device=b},c.device);a.plugins=[];f.scope.collections.findAll("plugins",d.id,a.plugins,c.plugins);a.devices=[];f.scope.collections.findAll("devices",d.id,a.devices,c.devices);a.triggers=[];f.scope.collections.findAll("triggers",d.id,a.triggers,c.triggers);b.info("device-ctrl")}}]).factory("jarvisWidgetDeviceService",
["genericResourceService",function(a){return{device:a.crud(["devices"]),plugins:a.links(["devices"],["plugins","scripts"]),devices:a.links(["devices"],["devices"]),triggers:a.links(["devices"],["triggers"])}}]).directive("jarvisWidgetDevices",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/device/jarvis-widget-devices.html",link:function(a,b,c){}}}]).directive("jarvisDevices",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/device/partials/jarvis-devices.html",
link:function(a,b,c){}}}]).directive("jarvisWidgetDevice",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/device/jarvis-widget-device.html",link:function(a,b,c){}}}]).directive("jarvisDeviceGeneral",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/device/partials/jarvis-device-general.html",link:function(a,b,c){}}}]).directive("jarvisDevicePlugin",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/device/partials/jarvis-device-plugin.html",
link:function(a,b,c){}}}]).directive("jarvisDeviceRender",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/device/partials/jarvis-device-render.html",link:function(a,b,c){}}}]);"use strict";
angular.module("jarvis.directives.event",["JarvisApp.services"]).controller("eventsCtrl",["$scope","$log","genericScopeService","genericResourceService","jarvisWidgetEventService",function(a,b,e,d,c){e.scope.resources(function(b){a.events=b},function(){return a.events},a,"events",c.event);a.crud=d.crud(["events"])}]).factory("jarvisWidgetEventService",["genericResourceService",function(a){return{event:a.crud(["events"])}}]).directive("jarvisWidgetEvents",["$log","$stateParams",function(a,b){return{restrict:"E",
templateUrl:"/ui/js/directives/events/jarvis-widget-events.html",link:function(a,b,c){}}}]).directive("jarvisEvents",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/events/jarvis-events.html",link:function(a,b,c){}}}]);"use strict";
angular.module("jarvis.directives.home",["JarvisApp.services"]).controller("jarvisWidgetHomeCtrl",["$scope","$rootScope","$store","$log","jarvisWidgetViewService","jarvisWidgetDeviceService","toastService","oauth2ResourceService",function(a,b,e,d,c,g,f,h){a.onSwipeLeft=function(){a.tabIndex>=a.views.length-1?a.tabIndex=a.views.length-1:a.tabIndex++};a.onSwipeRight=function(){0>=a.tabIndex?a.tabIndex=0:a.tabIndex--};a.selectTab=function(b,c){a.tabIndex=c};a.activeTab=function(b,c){return a.tabIndex==
c};a.load=function(){a.store=e;a.views=[];a.tabIndex=-1;c.view.findAll(function(b){var e=[];_.forEach(b,function(a){a.ishome&&(a.urlBackground="url('"+a.url+"')",e.push(a))});f.info(e.length+" view(s)");_.forEach(e,function(a){d.info("loading view",a);c.devices.findAll(a.id,function(b){a.devices=b;var c=_.after(a.devices.length,function(){d.debug("Linked devices to view",a.devices)});_.forEach(a.devices,function(a){g.device.task(a.id,"render",{},function(b){a.render=b;c(a)},f.failure)})},f.failure)});
a.views=e;0<a.views.length&&(a.tabIndex=0)},f.failure);d.info("home-ctrl")}}]).controller("helperCtrl",["$scope","$store","$log","jarvisWidgetViewService","jarvisWidgetDeviceService","toastService",function(a,b,e,d,c,g){}]).factory("jarvisWidgetHomeService",["genericResourceService",function(a){return{}}]).directive("jarvisWidgetHome",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/home/jarvis-widget-home.html",link:function(a,b,c){}}}]).directive("jarvisHome",
["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/home/partials/jarvis-home.html",link:function(a,b,c){}}}]);
angular.module("jarvis.directives.navigator",["JarvisApp.services"]).controller("jarvisWidgetNavigatorCtrl",["$scope","$log","$stateParams",function(a,b,e){a.resources=e.resources;a.answer=function(a){a.callback(a)}}]).factory("jarvisWidgetNavigatorService",["$q","$location","$log","jarvisWidgetSnapshotService","jarvisWidgetBlockService","jarvisWidgetConfigurationService","jarvisWidgetPropertyService","jarvisWidgetViewService","jarvisWidgetTriggerService","jarvisWidgetScenarioService","jarvisWidgetCronService",
"jarvisWidgetConnectorService","jarvisWidgetCommandService","jarvisWidgetPluginService","jarvisWidgetDeviceService",function(a,b,e,d,c,g,f,h,k,n,l,m,q,p,r){return{devices:function(){var c=a.defer();r.device.findAll(function(a){_.each(a,function(a){r.plugins.findAll(a.id,function(b){a.desc="";_.each(b,function(b){a.desc+=b.name})});a.selectable=!0;a.callback=function(a){b.path("/devices/"+a.id)};a.ext=angular.toJson(angular.fromJson(a.parameters),!0)});c.resolve({elements:a,title:"Devices",route:"/devices"})});
return c.promise},plugins:function(){var c=a.defer();p.scripts.findAll(function(a){_.each(a,function(a){p.commands.findAll(a.id,function(b){a.desc="";_.each(b,function(b){a.desc+=b.name})});a.selectable=!0;a.callback=function(a){b.path("/plugins/scripts/"+a.id)}});c.resolve({elements:a,title:"Plugins",route:"/plugins"})});return c.promise},commands:function(){var c=a.defer();q.command.findAll(function(a){_.each(a,function(a){a.ext=a.body;a.selectable=!0;a.callback=function(a){b.path("/commands/"+
a.id)}});c.resolve({elements:a,title:"Commands",route:"/commands"})});return c.promise},snapshots:function(){var c=a.defer();d.snapshot.findAll(function(a){_.each(a,function(a){a.selectable=!0;a.callback=function(a){b.path("/snapshots/"+a.id)}});c.resolve({elements:a,title:"Snapshots",route:"/snapshots"})});return c.promise},blocks:function(){var d=a.defer();c.block.findAll(function(a){_.each(a,function(a){a.selectable=!0;a.callback=function(a){b.path("/blocks/"+a.id)}});d.resolve({elements:a,title:"Blocks",
route:"/blocks"})});return d.promise},configurations:function(){var c=a.defer();g.configuration.findAll(function(a){_.each(a,function(a){a.selectable=!0;a.callback=function(a){b.path("/configurations/"+a.id)}});c.resolve({elements:a,title:"Configurations",route:"/configurations"})});return c.promise},properties:function(){var c=a.defer();f.property.findAll(function(a){_.each(a,function(a){a.selectable=!0;a.callback=function(a){b.path("/properties/"+a.id)}});c.resolve({elements:a,title:"Properties",
route:"/properties"})});return c.promise},views:function(){var c=a.defer();h.view.findAll(function(a){_.each(a,function(a){a.selectable=!0;a.callback=function(a){b.path("/views/"+a.id)}});c.resolve({elements:a,title:"Views",route:"/views"})});return c.promise},triggers:function(){var c=a.defer();k.trigger.findAll(function(a){_.each(a,function(a){a.selectable=!0;a.callback=function(a){b.path("/triggers/"+a.id)}});c.resolve({elements:a,title:"Triggers",route:"/triggers"})});return c.promise},scenarios:function(){var c=
a.defer();n.scenario.findAll(function(a){_.each(a,function(a){a.selectable=!0;a.callback=function(a){b.path("/scenarios/"+a.id)}});c.resolve({elements:a,title:"Scenarios",route:"/scenarios"})});return c.promise},crons:function(){var c=a.defer();l.cron.findAll(function(a){_.each(a,function(a){a.selectable=!0;a.callback=function(a){b.path("/crons/"+a.id)}});c.resolve({elements:a,title:"Crontab",route:"/crons"})});return c.promise},connectors:function(){var c=a.defer();m.connector.findAll(function(a){_.each(a,
function(a){a.selectable=!0;a.callback=function(a){b.path("/connectors/"+a.id)}});c.resolve({elements:a,title:"Connectors",route:"/connectors"})});return c.promise}}}]).directive("jarvisWidgetNavigator",["$log","$location","$stateParams","jarvisWidgetNavigatorService",function(a,b,e,d){return{restrict:"E",templateUrl:"/ui/js/directives/navigator/jarvis-widget-navigator.html",link:function(a,b,d){}}}]).directive("jarvisNavigator",["$log","$location","$stateParams","jarvisWidgetNavigatorService",function(a,
b,e,d){return{restrict:"E",templateUrl:"/ui/js/directives/navigator/partials/jarvis-navigator.html",link:function(a,e,f){a.elements=[];e=null;"devices"===f.resource&&(e=d.devices());"plugins"===f.resource&&(e=d.plugins());"commands"===f.resource&&(e=d.commands());"snapshots"===f.resource&&(e=d.snapshots());"blocks"===f.resource&&(e=d.blocks());"configurations"===f.resource&&(e=d.configurations());"properties"===f.resource&&(e=d.properties());"views"===f.resource&&(e=d.views());"triggers"===f.resource&&
(e=d.triggers());"scenarios"===f.resource&&(e=d.scenarios());"crons"===f.resource&&(e=d.crons());"connectors"===f.resource&&(e=d.connectors());null!=e&&e.then(function(d){a.elements.push({name:d.title,selectable:!0,callback:function(a){b.path(d.route)},nodes:d.elements})})}}}]);"use strict";
angular.module("jarvis.directives.notification",["JarvisApp.services"]).controller("notificationsCtrl",["$scope","$log","genericScopeService","jarvisWidgetNotificationService",function(a,b,e,d){e.scope.resources(function(b){a.notifications=b},function(){return a.notifications},a,"notifications",d.notification,{name:"notification name",icon:"settings_remote"})}]).controller("notificationCtrl",["$scope","$log","$stateParams","genericResourceService","genericScopeService","genericPickerService","jarvisWidgetNotificationService",
"toastService",function(a,b,e,d,c,g,f,h){c.scope.resource(a,"notification","notifications",f.notification);a.test=function(a,b,c,d){f.notification.task(a.id,"test",{text:b,title:c,subtext:d},function(b){h.info("notification "+a.name+"#"+a.id+" tested")},h.failure)};a.load=function(){a.combo={types:f.types};d.scope.entity.get(e.id,function(b){a.notification=b},f.notification);b.info("notification-ctrl",a.notification)}}]).factory("jarvisWidgetNotificationService",["genericResourceService",function(a){return{notification:a.crud(["notifications"]),
types:[{id:"SLACK",value:"notification.slack"},{id:"MAIL",value:"notification.mail"}]}}]).directive("jarvisWidgetNotifications",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/notification/jarvis-widget-notifications.html",link:function(a,b,c){}}}]).directive("jarvisWidgetNotification",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/notification/jarvis-widget-notification.html",link:function(a,b,c){}}}]).directive("jarvisNotifications",
["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/notification/partials/jarvis-notifications.html",link:function(a,b,c){}}}]).directive("jarvisNotification",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/notification/partials/jarvis-notification-general.html",link:function(a,b,c){}}}]).directive("jarvisNotificationTest",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/notification/partials/jarvis-notification-test.html",
link:function(a,b,c){}}}]);"use strict";
angular.module("jarvis.directives.plugin",["JarvisApp.services"]).controller("pluginsCtrl",["$scope","$log","genericScopeService","jarvisWidgetPluginService",function(a,b,e,d){e.scope.resources(function(b){a.plugins=b},function(){return a.plugins},a,"plugins/scripts",d.scripts,{name:"script name",icon:"list",type:"script"})}]).controller("pluginScriptCtrl",["$scope","$log","$stateParams","genericResourceService","genericScopeService","genericPickerService","jarvisWidgetPluginService","jarvisWidgetDeviceService",
"toastService",function(a,b,e,d,c,g,f,h,k){c.scope.resource(a,"script","plugins",f.scripts);a.links={commands:{}};c.scope.resourceLink(function(){return a.commands},a.links.commands,"script","plugins",f.scripts,f.commands,{order:"1",name:"noname",nature:"json",type:"data"},e.id);a.execute=function(c){void 0!=c&&void 0!=c.id&&""!=c.id&&f.scripts.task(c.id,"execute",a.rawTestData,function(d){b.debug("pluginScriptCtrl::execute",c,d);a.rawoutput=d;a.output=angular.toJson(d,!0)},k.failure)};a.render=function(c){void 0!=
c&&void 0!=c.id&&""!=c.id&&f.scripts.task(c.id,"render",a.rawTestData,function(d){b.debug("pluginScriptCtrl::render",c,d);a.rawoutput=d;a.output=angular.toJson(d,!0)},k.failure)};a.submit=function(){a.rawTestData=angular.fromJson(a.editTestData);a.jsonTestData=angular.toJson(a.rawTestData,!0)};a.clear=function(){a.rawoutput={};a.output=angular.toJson({},!0);a.rawTestData={};a.editTestData=angular.toJson(a.rawTestData,!0);a.jsonTestData=angular.toJson(a.rawTestData,!0)};a.setOwner=function(b){a.script.owner=
b.id};a.load=function(){a.activeTab=e.tab;a.clear();a.combo={booleans:[{id:!0,value:"True"},{id:!1,value:"False"}]};d.scope.entity.get(e.id,function(b){a.script=b},f.scripts);a.commands=[];d.scope.collections.findAll("commands",e.id,a.commands,f.commands);a.combo.owners=[{id:void 0,name:"device.empty"}];d.scope.combo.findAll("owner",a.combo.owners,h.device);b.info("script-ctrl",a.script)}}]).factory("jarvisWidgetPluginService",["Restangular","filterService","genericResourceService",function(a,b,e){return{plugins:{findAll:function(d,
c){var e=[],f=["scripts"],h=_.after(f.length,function(a){d(a)});_.forEach(f,function(d){a.all("plugins").all(d).getList().then(function(a){_.forEach(a,function(a){e.push(b.plain(a))});h(e)},function(a){c(a)})})}},scripts:e.crud(["plugins","scripts"]),commands:e.links(["plugins","scripts"],["commands"])}}]).directive("jarvisWidgetPlugins",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/plugin/jarvis-widget-plugins.html",link:function(a,b,c){}}}]).directive("jarvisPlugins",
["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/plugin/partials/jarvis-plugins.html",link:function(a,b,c){}}}]).directive("jarvisWidgetPlugin",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/plugin/jarvis-widget-plugin.html",link:function(a,b,c){}}}]).directive("jarvisPluginGeneral",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/plugin/partials/jarvis-plugin-general.html",link:function(a,
b,c){}}}]).directive("jarvisPluginResult",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/plugin/partials/jarvis-plugin-result.html",link:function(a,b,c){}}}]).directive("jarvisPluginScript",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/plugin/partials/jarvis-plugin-script.html",link:function(a,b,c){}}}]);"use strict";
angular.module("jarvis.directives.property",["JarvisApp.services"]).controller("propertiesCtrl",["$scope","$log","genericScopeService","jarvisWidgetPropertyService",function(a,b,e,d){e.scope.resources(function(b){a.properties=b},function(){return a.properties},a,"properties",d.property,{key:"key",value:"value"})}]).controller("propertyCtrl",["$scope","$log","$stateParams","$mdDialog","genericResourceService","genericScopeService","jarvisWidgetPropertyService","toastService",function(a,b,e,d,c,g,f,
h){g.scope.resource(a,"property","properties",f.property);a.load=function(){c.scope.entity.get(e.id,function(b){a.property=b},f.property);b.info("property-ctrl",a.properties)}}]).factory("jarvisWidgetPropertyService",["genericResourceService",function(a){return{property:a.crud(["properties"])}}]).directive("jarvisWidgetProperties",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/property/jarvis-widget-properties.html",link:function(a,b,c){}}}]).directive("jarvisProperties",
["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/property/partials/jarvis-properties.html",link:function(a,b,c){}}}]).directive("jarvisWidgetProperty",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/property/jarvis-widget-property.html",link:function(a,b,c){}}}]).directive("jarvisProperty",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/property/partials/jarvis-property-general.html",
link:function(a,b,c){}}}]);"use strict";
angular.module("jarvis.directives.scenario",["JarvisApp.services"]).controller("scenariosCtrl",["$scope","$log","genericScopeService","jarvisWidgetScenarioService","toastService",function(a,b,e,d,c){e.scope.resources(function(b){a.scenarios=b},function(){return a.scenarios},a,"scenarios",d.scenario,{name:"scenario name",icon:"list"})}]).controller("scenarioCtrl",["$scope","$log","$stateParams","$mdDialog","genericScopeService","genericResourceService","genericPickerService","jarvisWidgetScenarioService",
"jarvisWidgetBlockService","jarvisWidgetPluginService","toastService",function(a,b,e,d,c,g,f,h,k,n,l){c.scope.resource(a,"scenario","scenarios",h.scenario);a.links={blocks:{},triggers:{}};c.scope.resourceLink(function(){return a.blocks},a.links.blocks,"scenario","scenarios",h.scenario,h.blocks,{order:"1"},e.id);c.scope.resourceLink(function(){return a.triggers},a.links.triggers,"scenario","scenarios",h.scenario,h.triggers,{order:"1"},e.id);a.build=function(a){var c=[];_.each(a,function(a){b.debug("graph",
a.stage);var d="";_.each(a.nodes,function(a){a.start&&(d+="#"+a.id+"\x3d\x3estart: "+a.name+":\x3e"+a.longId+"\n");a.end&&(d+="#"+a.id+"\x3d\x3eend: "+a.name+":\x3e"+a.longId+"\n");a.activity&&(d+="#"+a.id+"\x3d\x3eoperation: "+a.name+":\x3e"+a.longId+"\n");a.gateway&&(d+="#"+a.id+"\x3d\x3econdition: "+a.name+":\x3e"+a.longId+"\n");a.call&&(d+="#"+a.id+"\x3d\x3esubroutine: "+a.name+":\x3e"+a.longId+"\n")});_.each(a.edges,function(b){d=a.nodes[b.sourceId].gateway?b.bool?d+("#"+b.sourceId+"(yes, right)-\x3e#"+
b.targetId+"\n"):d+("#"+b.sourceId+"(no)-\x3e#"+b.targetId+"\n"):d+("#"+b.sourceId+"-\x3e#"+b.targetId+"\n")});c.push({stage:a.stage,code:d})});return c};a.render=function(a){b.debug(a);$("#canvas").html("");_.each(a,function(a){$("#canvas").append("\x3ch4\x3e"+a.stage+"\x3c/h4\x3e");$("#canvas").append('\x3cdiv id\x3d"canvas-'+a.stage+'"\x3e\x3c/div\x3e')});_.each(a,function(a){b.info("Render",a.stage);flowchart.parse(a.code).drawSVG("canvas-"+a.stage,{"line-width":3,"line-length":50,"text-margin":10,
"font-size":12,font:"normal","font-family":"Helvetica","font-weight":"normal","font-color":"black","line-color":"black","element-color":"black",fill:"white","yes-text":"yes","no-text":"no","arrow-end":"block",scale:1,symbols:{start:{"font-color":"green","element-color":"green",fill:"yellow"},end:{"font-color":"red","element-color":"red",fill:"yellow"}},flowstate:{past:{fill:"#CCCCCC","font-size":12},current:{fill:"yellow","font-color":"red","font-weight":"bold"},future:{fill:"#FFFF99"},request:{fill:"blue"},
invalid:{fill:"#444444"},approved:{fill:"#58C4A3","font-size":12,"yes-text":"APPROVED","no-text":"n/a"},rejected:{fill:"#C45879","font-size":12,"yes-text":"n/a","no-text":"REJECTED"}}})})};a.chart=function(c){void 0!=c&&void 0!=c.id&&""!=c.id&&h.scenario.task(c.id,"render",{},function(d){b.debug("[SCENARIO/render]",c,d);a.codes=a.build(d);a.render(a.codes)},l.failure)};a.execute=function(c){void 0!=c&&void 0!=c.id&&""!=c.id&&h.scenario.task(c.id,"execute",{},function(d){b.debug("[SCENARIO/execute]",
c,d);a.console=d},l.failure)};a.load=function(){a.activeTab=e.tab;a.plugin={};g.scope.entity.get(e.id,function(b){a.scenario=b;a.chart(b)},h.scenario);a.blocks=[];g.scope.collections.findAll("blocks",e.id,a.blocks,h.blocks,function(a){_.forEach(a,function(a){a.plugins={};a.plugins.if=[];a.plugins.then=[];a.plugins.else=[];k.plugins.if.findAll(a.id,function(b){a.plugins.if=b});k.plugins.then.findAll(a.id,function(b){a.plugins.then=b});k.plugins.else.findAll(a.id,function(b){a.plugins.else=b});a.blocks=
{};a.blocks.then=[];a.blocks.else=[];k.blocks.then.findAll(a.id,function(b){a.blocks.then=b});k.blocks.else.findAll(a.id,function(b){a.blocks.else=b});b.debug("blocks.plugins",a.plugins);b.debug("blocks.blocks",a.blocks)})});a.triggers=[];g.scope.collections.findAll("triggers",e.id,a.triggers,h.triggers);b.debug("scenario-ctrl",a.scenario)}}]).factory("jarvisWidgetScenarioService",["genericResourceService",function(a){return{scenario:a.crud(["scenarios"]),blocks:a.links(["scenarios"],["blocks"]),
triggers:a.links(["scenarios"],["triggers"])}}]).directive("jarvisWidgetScenarios",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/scenario/jarvis-widget-scenarios.html",link:function(a,b,c){}}}]).directive("jarvisScenarios",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/scenario/partials/jarvis-scenarios.html",link:function(a,b,c){}}}]).directive("jarvisWidgetScenario",["$log","$stateParams",function(a,b){return{restrict:"E",
templateUrl:"/ui/js/directives/scenario/jarvis-widget-scenario.html",link:function(a,b,c){}}}]).directive("jarvisScenario",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/scenario/partials/jarvis-scenario-general.html",link:function(a,b,c){}}}]).directive("jarvisScenarioBlock",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/scenario/partials/jarvis-scenario-block.html",link:function(a,b,c){}}}]).directive("jarvisScenarioBlocks",
["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/scenario/partials/jarvis-scenario-blocks.html",link:function(a,b,c){}}}]).directive("jarvisScenarioConsole",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/scenario/partials/jarvis-scenario-console.html",link:function(a,b,c){}}}]).directive("jarvisScenarioGraph",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/scenario/partials/jarvis-scenario-graph.html",
link:function(a,b,c){}}}]);"use strict";
angular.module("jarvis.directives.snapshot",["JarvisApp.services","JarvisApp.directives.files"]).controller("snapshotsCtrl",["$scope","$log","genericScopeService","jarvisWidgetSnapshotService",function(a,b,e,d){e.scope.resources(function(b){a.snapshots=b},function(){return a.snapshots},a,"snapshots",d.snapshot,{name:"snapshot name",icon:"list"})}]).controller("snapshotCtrl",["$scope","$log","$stateParams","$filter","$http","genericResourceService","genericScopeService","jarvisWidgetSnapshotService",
"toastService",function(a,b,e,d,c,g,f,h,k){f.scope.resource(a,"snapshot","snapshots",h.snapshot);a.restore=function(a){void 0!=a&&void 0!=a.id&&""!=a.id&&h.snapshot.task(a.id,"restore",{},function(c){b.debug("snapshotCtrl::restore",a,c)},k.failure)};a.download=function(a){void 0!=a&&void 0!=a.id&&""!=a.id&&h.snapshot.task(a.id,"download",{},function(c){var e="export-"+d("date")(new Date,"yyyyMMdd-HHmmss")+".json",f=document.createElement("a");document.body.appendChild(f);f.style="display: none";b.debug("snapshot",
a,c);c=new Blob([angular.toJson(c,!0)],{type:"application/text"});c=window.URL.createObjectURL(c);f.href=c;f.download=e;f.click()},k.failure)};a.upload=function(a){$("#"+a).trigger("click")};a.loaded=function(a,c){a.json=c.data;b.debug("loaded",a,c)};a.load=function(){a.snapshots=[];g.scope.entity.get(e.id,function(b){a.snapshot=b},h.snapshot);b.info("snapshot-ctrl",a.snapshot)}}]).factory("jarvisWidgetSnapshotService",["genericResourceService",function(a){return{snapshot:a.crud(["snapshots"])}}]).directive("jarvisWidgetSnapshots",
["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/snapshot/jarvis-widget-snapshots.html",link:function(a,b,c){}}}]).directive("jarvisSnapshots",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/snapshot/partials/jarvis-snapshots.html",link:function(a,b,c){}}}]).directive("jarvisWidgetSnapshot",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/snapshot/jarvis-widget-snapshot.html",link:function(a,
b,c){}}}]).directive("jarvisSnapshot",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/snapshot/partials/jarvis-snapshot-general.html",link:function(a,b,c){}}}]);"use strict";
angular.module("jarvis.directives.trigger",["JarvisApp.services"]).controller("jarvisWidgetTriggersCtrl",["$scope","$log","genericScopeService","jarvisWidgetTriggerService",function(a,b,e,d){e.scope.resources(function(b){a.triggers=b},function(){return a.triggers},a,"triggers",d.trigger,{name:"trigger name",icon:"settings_remote"})}]).controller("jarvisWidgetTriggerCtrl",["$scope","$log","$stateParams","genericResourceService","genericScopeService","genericPickerService","jarvisWidgetTriggerService",
"toastService",function(a,b,e,d,c,g,f,h){c.scope.resource(a,"trigger","triggers",f.trigger);a.links={crons:{}};c.scope.resourceLink(function(){return a.crons},a.links.crons,"cron","crons",f.trigger,f.crons,{order:"1"},e.id);a.execute=function(a){f.trigger.task(a.id,"execute",{},function(b){h.info("trigger "+a.name+"#"+a.id+" executed")},h.failure)};a.load=function(){d.scope.entity.get(e.id,function(b){a.trigger=b},f.trigger);a.crons=[];d.scope.collections.findAll("crons",e.id,a.crons,f.crons);b.info("trigger-ctrl",
a.trigger)}}]).factory("jarvisWidgetTriggerService",["genericResourceService",function(a){return{trigger:a.crud(["triggers"]),crons:a.links(["triggers"],["crons"])}}]).directive("jarvisWidgetTriggers",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/trigger/jarvis-widget-triggers.html",link:function(a,b,c){}}}]).directive("jarvisTriggers",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/trigger/partials/jarvis-triggers.html",
link:function(a,b,c){}}}]).directive("jarvisWidgetTrigger",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/trigger/jarvis-widget-trigger.html",link:function(a,b,c){}}}]).directive("jarvisTriggerGeneral",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/trigger/partials/jarvis-trigger-general.html",link:function(a,b,c){}}}]).directive("jarvisTriggerCron",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/trigger/partials/jarvis-trigger-cron.html",
link:function(a,b,c){}}}]);"use strict";
angular.module("jarvis.directives.view",["JarvisApp.services"]).controller("viewsCtrl",["$scope","$log","genericScopeService","jarvisWidgetViewService",function(a,b,e,d){b.info("viewsCtrl");e.scope.resources(function(b){a.views=b},function(){return a.views},a,"views",d.view,{name:"view name",icon:"list"});b.info("views-ctrl",a.views)}]).controller("viewCtrl",["$scope","$log","$stateParams","genericResourceService","genericScopeService","jarvisWidgetViewService","toastService",function(a,b,e,d,c,g,
f){c.scope.resource(a,"view","views",g.view);a.links={devices:{}};c.scope.resourceLink(function(){return a.devices},a.links.devices,"view","views",g.view,g.devices,{order:"1"},e.id);a.load=function(){a.views=[];d.scope.entity.get(e.id,function(b){a.view=b},g.view);a.devices=[];d.scope.collections.findAll("devices",e.id,a.devices,g.devices);b.info("view-ctrl",a.views)}}]).factory("jarvisWidgetViewService",["genericResourceService",function(a){return{view:a.crud(["views"]),devices:a.links(["views"],
["devices"])}}]).directive("jarvisWidgetViews",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/view/jarvis-widget-views.html",link:function(a,b,c){}}}]).directive("jarvisViews",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/view/partials/jarvis-views.html",link:function(a,b,c){}}}]).directive("jarvisWidgetView",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/view/jarvis-widget-view.html",
link:function(a,b,c){}}}]).directive("jarvisViewGeneral",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/directives/view/partials/jarvis-view-general.html",link:function(a,b,c){}}}]);